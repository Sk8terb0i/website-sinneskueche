import{r as i,j as e}from"./vendor-5u_9lpUi.js";import{p as We,d as l,a as v}from"./index-BcH7TOvZ.js";import{c as S,h as Fe,s as Ne,j as qe,k as L,f as d,l as ae,q as A,o as B,b as oe,e as re,u as I,m as Pe,d as de}from"./vendor-firebase-CmSCscF-.js";import{n as _e,o as Me,p as He,q as ce,g as Oe,T as W,r as Ue,s as pe,C as Ye,t as $e}from"./vendor-icons-CsV9dEbO.js";import"./vendor-animation-DHy22ush.js";function lt(){const[c,me]=i.useState(null),[w,ye]=i.useState(""),[N,he]=i.useState(""),[q,P]=i.useState(!1),[a,fe]=i.useState(window.innerWidth<900),[_,ge]=i.useState([]),[M,k]=i.useState(""),[H,m]=i.useState(""),[O,g]=i.useState(""),[U,j]=i.useState(""),[p,E]=i.useState("course"),[Y,$]=i.useState(""),[z,y]=i.useState(""),[u,X]=i.useState(null),[D,je]=i.useState([]),[be,ve]=i.useState([]),[T,G]=i.useState(""),[J,K]=i.useState(""),[Q,V]=i.useState(""),Z=S(l,"events"),Se=S(l,"rent_requests"),ee=S(l,"rental_availability"),h=Array.from(new Map(We.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values());i.useEffect(()=>{const t=()=>fe(window.innerWidth<900);window.addEventListener("resize",t);const s=Fe(v,n=>{me(n),n&&(R(),te(),Ce(),we())});return()=>{s(),window.removeEventListener("resize",t)}},[]);const Ce=()=>{de(A(Se,B("createdAt","desc")),t=>{je(t.docs.map(s=>({id:s.id,...s.data()})))}),de(A(ee,B("date","asc")),t=>{ve(t.docs.map(s=>({id:s.id,...s.data()})))})},we=async()=>{const t=await oe(S(l,"settings"));if(!t.empty){const s=t.docs.find(n=>n.id==="admin_config");s&&V(s.data().adminEmail||"")}},ke=async()=>{try{await ae(d(l,"settings","admin_config"),{adminEmail:Q},{merge:!0}),alert("Notification email saved! This email will now receive all rent request alerts.")}catch(t){alert("Error saving email: "+t.message)}},R=async()=>{try{const t=A(Z,B("date","asc")),s=await oe(t),n=new Date;n.setHours(0,0,0,0);const Ie=s.docs.map(b=>({...b.data(),id:b.id})).filter(b=>{const le=new Date(b.date);return le.setHours(0,0,0,0),le>=n});ge(Ie)}catch(t){console.error("Error fetching events:",t)}},te=()=>{h.length>0&&!u&&se(h[0].link)},se=t=>{const s=h.find(n=>n.link===t);$(t),s&&(g(s.text.en),j(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?m("18:30 - 21:30"):m(""))},Ee=async t=>{t.preventDefault();try{const n={date:M,time:H,title:{en:O,de:U},link:p==="event"?z:z||Y||"",type:p};u?await ae(d(l,"events",u),n):await re(Z,n),ie(),R()}catch(s){alert("Error saving: "+s.message)}},ze=async()=>{if(!T)return alert("Select a date");await re(ee,{date:T,time:J,status:"available"}),G(""),K("")},De=async t=>{await I(d(l,"rent_requests",t),{status:"approved"})},Te=async(t,s)=>{await I(d(l,"rent_requests",t),{status:"rejected"}),s&&await I(d(l,"rental_availability",s),{status:"available"})},Re=async t=>{window.confirm("Delete this availability?")&&await L(d(l,"rental_availability",t))},Le=async t=>{window.confirm("Delete this request?")&&await L(d(l,"rent_requests",t))},Ae=t=>{X(t.id),k(t.date),m(t.time||""),g(t.title.en),j(t.title.de);const s=t.type||(t.link?.startsWith("http")?"event":"course");E(s),s==="course"?h.some(ne=>ne.link===t.link)?($(t.link),y("")):y(t.link):y(t.link||""),window.scrollTo({top:0,behavior:"smooth"})},ie=()=>{X(null),k(""),m(""),y(""),g(""),j(""),p==="course"&&te()},Be=async t=>{t.preventDefault(),P(!0);try{await Pe(v,w,N)}catch(s){alert("Login failed: "+s.message)}finally{P(!1)}};return c?e.jsxs("div",{style:{padding:a?"1.5rem":"4vw",minHeight:"100vh",fontFamily:"Satoshi",color:"#1c0700"},children:[e.jsxs("header",{style:Je(a),children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:a?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",c.email]})]}),e.jsxs("button",{onClick:()=>qe(v),style:Ke,children:[e.jsx(He,{size:16})," ",!a&&"Logout"]})]}),e.jsx("h2",{style:{...x,color:"#4e5f28",fontSize:"1.2rem"},children:"1. Calendar Events"}),e.jsxs("div",{style:{display:a?"block":"flex",gap:"2rem",marginBottom:"5rem"},children:[e.jsx("section",{style:{width:a?"100%":"400px"},children:e.jsxs("div",{style:ue,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.2rem"},children:[e.jsx("h3",{style:x,children:u?"EDIT ENTRY":"NEW ENTRY"}),u&&e.jsxs("button",{onClick:ie,style:Ve,children:[e.jsx(ce,{size:14})," CANCEL"]})]}),e.jsxs("form",{onSubmit:Ee,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:r,children:"Source"}),e.jsxs("div",{style:Ze,children:[e.jsx("div",{onClick:()=>E("course"),style:{...xe,backgroundColor:p==="course"?"#caaff3":"transparent"},children:"Course"}),e.jsx("div",{onClick:()=>E("event"),style:{...xe,backgroundColor:p==="event"?"#caaff3":"transparent"},children:"Event"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"date",value:M,onChange:t=>k(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Time",value:H,onChange:t=>m(t.target.value),style:o})]}),p==="course"?e.jsx("select",{value:Y,onChange:t=>se(t.target.value),style:o,required:!0,children:h.map((t,s)=>e.jsx("option",{value:t.link,children:t.text.en},s))}):e.jsx("input",{type:"url",placeholder:"URL https://...",value:z,onChange:t=>y(t.target.value),style:o}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Title EN",value:O,onChange:t=>g(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Title DE",value:U,onChange:t=>j(t.target.value),required:!0,style:o})]}),e.jsx("button",{type:"submit",style:C,children:u?"Update Entry":"Add to Calendar"})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:x,children:[e.jsx(Oe,{size:16})," Scheduled Events (",_.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:_.map(t=>e.jsxs("div",{onClick:()=>Ae(t),style:F,children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800"},children:[t.date," ",t.time&&`• ${t.time}`]}),e.jsx("span",{style:{fontWeight:"600"},children:t.title.en})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),window.confirm("Delete?")&&L(d(l,"events",t.id)).then(R)},style:f,children:e.jsx(W,{size:18})})]},t.id))})]})]}),e.jsx("hr",{style:{opacity:.1,marginBottom:"4rem"}}),e.jsx("h2",{style:{...x,color:"#4e5f28",fontSize:"1.2rem"},children:"2. Rental Management"}),e.jsxs("div",{style:{display:a?"block":"flex",gap:"2rem"},children:[e.jsxs("section",{style:{width:a?"100%":"400px"},children:[e.jsxs("div",{style:ue,children:[e.jsxs("h3",{style:x,children:[e.jsx(Ue,{size:16})," Set Availability"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"date",value:T,onChange:t=>G(t.target.value),style:o}),e.jsx("input",{type:"text",placeholder:"Time slot (e.g. 10:00 - 16:00)",value:J,onChange:t=>K(t.target.value),style:o}),e.jsx("button",{onClick:ze,style:{...C,backgroundColor:"#4e5f28",color:"white"},children:"Publish Date"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h4",{style:r,children:"Persistent Notification Email"}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"email",placeholder:"Admin notification email",value:Q,onChange:t=>V(t.target.value),style:{...o,flex:1}}),e.jsx("button",{onClick:ke,style:{...C,width:"auto",padding:"0 15px"},title:"Save Email to Settings",children:e.jsx(pe,{size:16})})]}),e.jsx("p",{style:{fontSize:"0.7rem",opacity:.5,marginTop:"5px"},children:"Requests will be sent to this email until changed."})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:r,children:"Live Availabilities"}),be.map(t=>e.jsxs("div",{style:{...F,padding:"0.8rem",marginBottom:"0.5rem",opacity:t.status==="available"?1:.5},children:[e.jsxs("span",{style:{fontSize:"0.85rem"},children:[t.date," — ",e.jsx("strong",{children:t.status})]}),e.jsx("button",{onClick:()=>Re(t.id),style:f,children:e.jsx(W,{size:14})})]},t.id))]})]}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:x,children:[e.jsx(Ye,{size:16})," Incoming Rent Requests (",D.length,")"]}),D.length===0&&e.jsx("p",{style:{opacity:.5},children:"No requests yet."}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:D.map(t=>e.jsxs("div",{style:{...F,alignItems:"flex-start",flexDirection:"column",borderLeft:t.status==="approved"?"6px solid #4e5f28":t.status==="rejected"?"6px solid #ff4d4d":"6px solid #caaff3"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:t.name}),t.status!=="pending"&&e.jsx("span",{style:{fontSize:"0.6rem",background:"#eee",padding:"2px 8px",borderRadius:"100px",textTransform:"uppercase"},children:t.status})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>De(t.id),style:{...f,color:"#4e5f28",opacity:1},children:e.jsx($e,{size:22})}),e.jsx("button",{onClick:()=>Te(t.id,t.availabilityId),style:{...f,color:"#ff4d4d",opacity:1},children:e.jsx(ce,{size:22})})]}),e.jsx("a",{href:`mailto:${t.email}`,style:{color:"#caaff3"},children:e.jsx(pe,{size:20})}),e.jsx("button",{onClick:()=>Le(t.id),style:f,children:e.jsx(W,{size:20})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:a?"1fr":"1fr 1fr",gap:"10px",width:"100%",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Email:"})," ",t.email]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Phone:"})," ",t.phone]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Requested Date:"})," ",e.jsx("strong",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Received:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]},t.id))})]})]})]}):e.jsx("div",{style:Xe,children:e.jsxs("form",{onSubmit:Be,style:Ge(a),children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(_e,{size:a?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),e.jsx("label",{style:r,children:"Email"}),e.jsx("input",{type:"email",value:w,onChange:t=>ye(t.target.value),style:{...o,marginBottom:"1.2rem"},required:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:r,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>Ne(v,w),style:Qe,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:N,onChange:t=>he(t.target.value),style:{...o,marginBottom:"2rem"},required:!0}),e.jsx("button",{type:"submit",disabled:q,style:C,children:q?e.jsx(Me,{className:"spinner",size:18}):"Sign In"})]})})}const Xe={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},Ge=c=>({backgroundColor:"white",padding:c?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),Je=c=>({marginBottom:c?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),Ke={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},ue={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},r={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},o={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},C={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},Qe={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},x={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},Ve={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},F={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},f={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},Ze={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},xe={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{lt as default};
