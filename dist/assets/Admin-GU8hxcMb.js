import{r as i,j as e}from"./vendor-D5GVvvUv.js";import{p as ue,d as b,H as we,a as te}from"./index-DzV9UKL6.js";import{e as F,q as X,f as ie,c as Z,w as _e,v as Q,d as P,m as Ie,k as ye,r as fe,n as Oe,p as Ve,b as Ee,u as ce,x as Me,o as qe,s as Ke,l as Ye,h as Qe}from"./vendor-firebase-0sARrlKz.js";import{w as Pe,B as Xe,b as Ze,c as $e,p as ze,d as me,e as pe,L as $,U as Te,r as ae,s as De,S as Re,x as Ae,y as Je,z as et,D as tt,F as st,t as nt,J as xe,v as it,T as Ne,K as at,N as lt,O as rt,a as ot,k as dt,Q as ct}from"./vendor-icons-DbpC96mo.js";import"./vendor-animation-kCZsswUa.js";const se=y=>({display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"10px 20px",border:"none",cursor:"pointer",fontFamily:"Satoshi",fontSize:"0.9rem",fontWeight:"600",transition:"all 0.3s ease",whiteSpace:"nowrap"}),pt={display:"flex",gap:"8px",overflowX:"auto",padding:"6px",scrollbarWidth:"none",msOverflowStyle:"none"},Be={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem",backgroundColor:"#fffce3"},xt=y=>({backgroundColor:"#fdf8e1",padding:y?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.05)",width:"100%",maxWidth:"400px",border:"1px solid rgba(28, 7, 0, 0.05)"}),ut=y=>({marginBottom:y?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),yt={display:"flex",alignItems:"center",gap:"8px",background:"#fdf8e1",border:"1px solid rgba(28, 7, 0, 0.2)",padding:"10px 18px",borderRadius:"100px",cursor:"pointer",fontWeight:"bold",fontFamily:"Satoshi",fontSize:"0.85rem"},he={backgroundColor:"#fdf8e1",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)",border:"1px solid rgba(28, 7, 0, 0.05)"},h={display:"block",fontSize:"0.6rem",marginBottom:"6px",opacity:.4,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},v={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid rgba(28, 7, 0, 0.1)",backgroundColor:"rgba(255, 252, 227, 0.5)",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem",color:"#1c0700"},V={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"100px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%",fontFamily:"Satoshi"},ft={background:"none",border:"none",color:"#9960a8",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"lowercase",padding:0,opacity:.8},U={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.1rem",color:"#1c0700"},mt={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},M={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fdf8e1",borderRadius:"18px",border:"1px solid rgba(28, 7, 0, 0.05)",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease",cursor:"pointer"},ne={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},J={display:"flex",backgroundColor:"rgba(28, 7, 0, 0.05)",padding:"4px",borderRadius:"12px",width:"fit-content"},H={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};function ht({isMobile:y,currentLang:d}){const[T,R]=i.useState([]),[A,k]=i.useState(""),[N,z]=i.useState(""),[x,D]=i.useState(""),[n,r]=i.useState(""),[p,C]=i.useState("course"),[g,L]=i.useState(!1),[m,I]=i.useState(""),[w,S]=i.useState(""),[s,u]=i.useState(null),[c,B]=i.useState(null),[a,G]=i.useState({}),[W,q]=i.useState(null),[K,Le]=i.useState({}),j={en:{newEntry:"NEW ENTRY",editEntry:"EDIT ENTRY",cancel:"CANCEL",source:"Source",course:"Course",event:"Event",dateLabel:"Date",timeLabel:"Time",titleEn:"Title EN",titleDe:"Title DE",addBtn:"Add to Calendar",updateBtn:"Update Entry",courseHeader:"COURSES",eventHeader:"INDIVIDUAL EVENTS",noCourses:"No courses scheduled.",noEvents:"No events scheduled.",cancelCourse:"CANCEL COURSE",deleteConfirm:"Are you sure? This will refund all participants and delete the event.",participants:"Participants",noParticipants:"No bookings yet."},de:{newEntry:"NEUER EINTRAG",editEntry:"EINTRAG BEARBEITEN",cancel:"ABBRECHEN",source:"Quelle",course:"Kurs",event:"Event",dateLabel:"Datum",timeLabel:"Uhrzeit",titleEn:"Titel EN",titleDe:"Titel DE",addBtn:"Zum Kalender hinzufügen",updateBtn:"Eintrag aktualisieren",courseHeader:"KURSE",eventHeader:"EINZEL-EVENTS",noCourses:"Keine Kurse geplant.",noEvents:"Keine Events geplant.",cancelCourse:"KURS ABSAGEN",deleteConfirm:"Bist du sicher? Alle Teilnehmer erhalten eine Rückerstattung und der Termin wird gelöscht.",participants:"Teilnehmer",noParticipants:"Noch keine Buchungen."}}[d||"en"],ge=F(b,"events"),Y=Array.from(new Map(ue.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values());i.useEffect(()=>{le(),be()},[]);const le=async()=>{try{const t=X(ge,ie("date","asc")),l=await Z(t),o=new Date;o.setHours(0,0,0,0);const _=(await Promise.all(l.docs.map(async O=>{const ee=O.data(),Ue=X(F(b,"bookings"),_e("eventId","==",O.id)),ke=await Z(Ue);return{...ee,id:O.id,bookedCount:ke.size,bookings:ke.docs.map(Ge=>Ge.data())}}))).filter(O=>{const ee=new Date(O.date);return ee.setHours(0,0,0,0),ee<o?(Q(P(b,"events",O.id)),!1):!0});R(_)}catch(t){console.error("Error fetching events:",t)}},je=async t=>{if(W===t.id){q(null);return}if(t.bookedCount===0)return alert(j.noParticipants);if(!K[t.id]){const l=await Promise.all(t.bookings.map(async o=>{if(o.userId==="GUEST_USER")return{firstName:o.guestName||"Guest",lastName:"(Guest)",email:o.guestEmail||"Email not found",phone:"",isGuest:!0};const E=await Ie(P(b,"users",o.userId));return E.exists()?E.data():{firstName:"Unknown",lastName:"User",email:"N/A"}}));Le(o=>({...o,[t.id]:l}))}q(t.id)},be=()=>{Y.length>0&&!s&&!g&&ve(Y[0].link)},ve=t=>{const l=Y.find(o=>o.link===t);I(t),l&&(D(l.text.en),r(l.text.de),l.text.en.toLowerCase().includes("pottery tuesdays")?z("18:30 - 21:30"):z(""))},We=async t=>{t.preventDefault();try{const o={date:A,time:N,title:{en:x,de:n},link:p==="event"||g?w:m,type:p};s?await ye(P(b,"events",s),o):await fe(ge,o),Ce(),le()}catch(l){alert("Error saving: "+l.message)}},re=t=>{u(t.id),k(t.date),z(t.time||""),D(t.title.en),r(t.title.de);const l=t.type||(t.link?.startsWith("http")?"event":"course");C(l),l==="course"?Y.some(E=>E.link===t.link)?(I(t.link),S(""),L(!1)):(S(t.link),L(!0)):S(t.link||""),window.scrollTo({top:0,behavior:"smooth"})},Ce=()=>{u(null),k(""),z(""),S(""),D(""),r(""),L(!1),p==="course"&&be()},He=t=>{G(l=>({...l,[t]:!l[t]}))},Se=async(t,l)=>{if(t.stopPropagation(),!window.confirm(j.deleteConfirm))return;B(l.id);const o=Oe(),E=Ve(o,"adminCancelEvent");try{await E({eventId:l.id,currentLang:d||"en"}),await le()}catch(_){console.error(_),alert("Error cancelling event: "+_.message)}finally{B(null)}},oe=T.filter(t=>t.type==="course"),de=T.filter(t=>t.type==="event"),Fe=oe.reduce((t,l)=>{const o=l.link;return t[o]||(t[o]={title:l.title[d||"en"],link:l.link,dates:[]}),t[o].dates.push(l),t},{});return e.jsxs("div",{style:{display:y?"block":"flex",gap:"2rem",marginBottom:"5rem"},children:[e.jsx("section",{style:{width:y?"100%":"400px"},children:e.jsxs("div",{style:he,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.2rem"},children:[e.jsx("h3",{style:U,children:s?j.editEntry:j.newEntry}),s&&e.jsxs("button",{onClick:Ce,style:mt,children:[e.jsx(Pe,{size:14})," ",j.cancel]})]}),e.jsxs("form",{onSubmit:We,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:h,children:j.source}),e.jsxs("div",{style:J,children:[e.jsx("div",{onClick:()=>{C("course"),L(!1)},style:{...H,backgroundColor:p==="course"?"#caaff3":"transparent"},children:j.course}),e.jsx("div",{onClick:()=>C("event"),style:{...H,backgroundColor:p==="event"?"#caaff3":"transparent"},children:j.event})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsx("label",{style:{...h,opacity:.5},children:j.dateLabel}),e.jsx("input",{type:"date",value:A,onChange:t=>k(t.target.value),required:!0,style:v})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[e.jsx("label",{style:{...h,opacity:.5},children:j.timeLabel}),e.jsx("input",{type:"text",placeholder:"18:30",value:N,onChange:t=>z(t.target.value),style:v})]})]}),p==="course"&&!g?e.jsx("select",{value:m,onChange:t=>ve(t.target.value),style:v,required:!0,children:Y.map((t,l)=>e.jsx("option",{value:t.link,children:t.text[d||"en"]},l))}):e.jsx("input",{type:"url",placeholder:"URL https://...",value:w,onChange:t=>S(t.target.value),style:v,required:!0}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:j.titleEn,value:x,onChange:t=>D(t.target.value),required:!0,style:v}),e.jsx("input",{type:"text",placeholder:j.titleDe,value:n,onChange:t=>r(t.target.value),required:!0,style:v})]}),e.jsx("button",{type:"submit",style:V,children:s?j.updateBtn:j.addBtn})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:{...U,marginBottom:"1rem"},children:[e.jsx(Xe,{size:16})," ",j.courseHeader," (",oe.length,")"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"3rem"},children:[Object.values(Fe).map(t=>{const l=a[t.link];return e.jsxs("div",{style:f.courseGroupWrapper,children:[e.jsx("div",{onClick:()=>He(t.link),style:f.groupHeader,children:e.jsxs("div",{style:f.groupTitleText,children:[l?e.jsx(Ze,{size:14}):e.jsx($e,{size:14}),t.title," (",t.dates.length,")"]})}),l&&e.jsx("div",{style:f.expandedContent,children:t.dates.map(o=>e.jsxs("div",{style:f.eventItemWrapper,children:[e.jsxs("div",{style:{...M,padding:"0.8rem 1.2rem",backgroundColor:"#fdf8e1"},children:[e.jsx("button",{onClick:()=>re(o),style:f.editBtnIcon,children:e.jsx(ze,{size:16})}),e.jsxs("div",{style:f.eventMainInfo,children:[e.jsx("span",{style:f.dateLabel,children:o.date}),o.time&&e.jsxs("span",{style:f.timeLabel,children:[e.jsx(me,{size:12})," ",o.time]})]}),e.jsxs("div",{style:f.actionRow,children:[e.jsxs("button",{onClick:()=>je(o),style:{...f.participantBadge,opacity:o.bookedCount>0?1:.3},children:[e.jsx(pe,{size:16,color:"#4e5f28"}),e.jsx("span",{style:{fontWeight:"800"},children:o.bookedCount})]}),e.jsx("button",{onClick:E=>Se(E,o),style:f.cancelCourseBtn,disabled:c===o.id,children:c===o.id?e.jsx($,{size:14,className:"spinner"}):j.cancelCourse})]})]}),W===o.id&&K[o.id]&&e.jsxs("div",{style:f.participantPanel,children:[e.jsx("h5",{style:{fontSize:"0.6rem",marginBottom:"8px",opacity:.5},children:j.participants}),K[o.id].map((E,_)=>e.jsxs("div",{style:f.userRow,children:[e.jsx(Te,{size:12}),e.jsxs("strong",{style:{color:E.isGuest?"#9960a8":"inherit"},children:[E.firstName," ",E.lastName]}),e.jsxs("span",{style:f.contactText,children:[e.jsx(ae,{size:10})," ",E.email]}),E.phone&&e.jsxs("span",{style:f.contactText,children:[e.jsx(De,{size:10})," ",E.phone]})]},_))]})]},o.id))})]},t.link)}),oe.length===0&&e.jsx("p",{style:{opacity:.4,fontSize:"0.8rem"},children:j.noCourses})]}),e.jsxs("h3",{style:{...U,marginBottom:"1rem"},children:[e.jsx(Re,{size:16})," ",j.eventHeader," (",de.length,")"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:[de.map(t=>e.jsxs("div",{style:f.eventItemWrapper,children:[e.jsxs("div",{onClick:()=>re(t),style:{...M,backgroundColor:"#fdf8e1"},children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),re(t)},style:f.editBtnIcon,children:e.jsx(ze,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800"},children:[t.date," ",t.time&&`• ${t.time}`]}),e.jsx("span",{style:{fontWeight:"600"},children:t.title[d||"en"]})]}),e.jsxs("div",{style:f.actionRow,children:[e.jsxs("button",{onClick:l=>{l.stopPropagation(),je(t)},style:{...f.participantBadge,opacity:t.bookedCount>0?1:.3},children:[e.jsx(pe,{size:18,color:"#4e5f28"}),e.jsx("span",{style:{fontWeight:"800"},children:t.bookedCount})]}),e.jsx("button",{onClick:l=>Se(l,t),style:f.cancelCourseBtn,disabled:c===t.id,children:c===t.id?e.jsx($,{size:14,className:"spinner"}):j.cancelCourse})]})]}),W===t.id&&K[t.id]&&e.jsx("div",{style:f.participantPanel,children:K[t.id].map((l,o)=>e.jsxs("div",{style:f.userRow,children:[e.jsx(Te,{size:12}),e.jsxs("strong",{style:{color:l.isGuest?"#9960a8":"inherit"},children:[l.firstName," ",l.lastName]}),e.jsxs("span",{style:f.contactText,children:[e.jsx(ae,{size:10})," ",l.email]}),l.phone&&e.jsxs("span",{style:f.contactText,children:[e.jsx(De,{size:10})," ",l.phone]})]},o))})]},t.id)),de.length===0&&e.jsx("p",{style:{opacity:.4,fontSize:"0.8rem"},children:j.noEvents})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
      `})]})}const f={courseGroupWrapper:{borderLeft:"3px solid #caaff3",backgroundColor:"rgba(28, 7, 0, 0.02)",borderRadius:"0 12px 12px 0",padding:"0.5rem 1rem",marginBottom:"0.5rem"},groupHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",padding:"0.5rem 0"},groupTitleText:{fontWeight:"800",fontSize:"0.85rem",color:"#1c0700",textTransform:"uppercase",display:"flex",alignItems:"center",gap:"8px"},expandedContent:{display:"flex",flexDirection:"column",gap:"0.8rem",marginTop:"1rem"},eventItemWrapper:{display:"flex",flexDirection:"column",gap:"8px"},editBtnIcon:{background:"none",border:"none",cursor:"pointer",color:"#caaff3",padding:"4px",marginRight:"8px",display:"flex",alignItems:"center",opacity:.7},eventMainInfo:{flex:1,display:"flex",alignItems:"center",gap:"10px",fontSize:"0.85rem"},dateLabel:{color:"#caaff3",fontWeight:"700"},timeLabel:{opacity:.6,display:"flex",alignItems:"center",gap:"4px"},actionRow:{display:"flex",gap:"15px",alignItems:"center"},participantBadge:{border:"none",background:"none",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},cancelCourseBtn:{background:"rgba(255, 77, 77, 0.1)",border:"none",color:"#ff4d4d",padding:"6px 12px",borderRadius:"100px",fontSize:"0.7rem",fontWeight:"800",cursor:"pointer",textTransform:"uppercase",letterSpacing:"0.03rem",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"120px"},participantPanel:{backgroundColor:"rgba(78, 95, 40, 0.05)",padding:"10px 15px",borderRadius:"12px",border:"1px solid rgba(78, 95, 40, 0.1)"},userRow:{display:"flex",alignItems:"center",gap:"10px",fontSize:"0.8rem",marginBottom:"5px",color:"#1c0700"},contactText:{opacity:.6,fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"3px"}};function gt({isMobile:y}){const[d,T]=i.useState({}),[R,A]=i.useState(null),k=F(b,"course_settings"),N=Array.from(new Map(ue.filter(n=>n.type==="courses").flatMap(n=>n.courses||[]).filter(n=>n.link).map(n=>[n.link,n])).values());i.useEffect(()=>{z()},[]);const z=async()=>{try{const n=await Z(k),r={};n.docs.forEach(p=>{r[p.id]=p.data()}),T(r)}catch(n){console.error("Error fetching prices:",n)}},x=(n,r,p)=>{T(C=>({...C,[n]:{...C[n],[r]:p}}))},D=async(n,r)=>{A(n);const p=d[n]?.isPerHour??!1;try{const C={priceSingle:d[n]?.priceSingle||"",priceFull:d[n]?.priceFull||"",packSize:d[n]?.packSize||"10",duration:p&&d[n]?.duration||"",hasPack:d[n]?.hasPack??!1,isPerHour:p,hasCapacity:d[n]?.hasCapacity??!1,capacity:d[n]?.capacity||"",isVisible:d[n]?.isVisible??!0,courseName:r,updatedAt:new Date().toISOString()};await ye(P(b,"course_settings",n),C,{merge:!0})}catch(C){alert("Error saving: "+C.message)}finally{A(null)}};return e.jsxs("section",{style:{maxWidth:"800px",margin:"0 auto",paddingBottom:"5rem"},children:[e.jsxs("h3",{style:U,children:[e.jsx(Ae,{size:18})," Course Management"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:N.map(n=>{const r=n.link.replace(/\//g,""),p=d[r]?.priceSingle||"",C=d[r]?.priceFull||"",g=d[r]?.packSize||"10",L=d[r]?.duration||"",m=d[r]?.hasCapacity??!1,I=d[r]?.capacity||"",w=d[r]?.hasPack??!1,S=d[r]?.isPerHour??!1,s=d[r]?.isVisible??!0,u=R===r;return e.jsxs("div",{style:{...M,flexDirection:"column",alignItems:"stretch",gap:"1.5rem",padding:y?"1.5rem":"2rem",borderLeft:s?"6px solid #caaff3":"6px solid #ccc",backgroundColor:s?"#fdf8e1":"#f5f5f5"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"10px",borderBottom:"1px solid rgba(28,7,0,0.05)",paddingBottom:"1rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",color:"#1c0700"},children:n.text.en}),e.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:["Path: ",n.link]})]}),e.jsxs("div",{style:{...J,width:"fit-content",padding:"2px"},children:[e.jsxs("div",{onClick:()=>x(r,"isVisible",!0),style:{...H,padding:"6px 12px",fontSize:"0.7rem",backgroundColor:s?"#caaff3":"transparent"},children:[e.jsx(Je,{size:14})," ",!y&&"Visible"]}),e.jsxs("div",{onClick:()=>x(r,"isVisible",!1),style:{...H,padding:"6px 12px",fontSize:"0.7rem",backgroundColor:s?"transparent":"#666",color:s?"inherit":"white"},children:[e.jsx(et,{size:14})," ",!y&&"Hidden"]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:y?"column":"row",gap:"1.5rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("label",{style:{...h,fontSize:"0.75rem",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(tt,{size:14})," Base Pricing Type"]}),e.jsxs("div",{style:{...J,padding:"2px",width:"100%"},children:[e.jsx("div",{onClick:()=>x(r,"isPerHour",!1),style:{...H,flex:1,padding:"8px",fontSize:"0.75rem",backgroundColor:S?"transparent":"#caaff3"},children:"Session Based"}),e.jsx("div",{onClick:()=>x(r,"isPerHour",!0),style:{...H,flex:1,padding:"8px",fontSize:"0.75rem",backgroundColor:S?"#caaff3":"transparent"},children:"Time Based"})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",gap:"10px"},children:[e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{...h,fontSize:"0.75rem"},children:S?"Price":"Single Price"}),e.jsx("input",{style:v,placeholder:"45 CHF",value:p,onChange:c=>x(r,"priceSingle",c.target.value)})]}),S&&e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{...h,fontSize:"0.75rem"},children:"Mins"}),e.jsx("input",{type:"number",style:v,value:L,onChange:c=>x(r,"duration",c.target.value)})]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:y?"column":"row",gap:"1rem"},children:[e.jsxs("div",{style:{flex:1,backgroundColor:w?"rgba(202, 175, 243, 0.1)":"transparent",padding:"12px",borderRadius:"12px",border:w?"1px solid #caaff3":"1px solid rgba(28,7,0,0.05)"},children:[e.jsxs("label",{style:{...h,display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginBottom:w?"12px":0},children:[e.jsx("input",{type:"checkbox",checked:w,onChange:c=>x(r,"hasPack",c.target.checked)}),"Enable Session Packs"]}),w&&e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:"0.65rem",fontWeight:"bold"},children:"Size"}),e.jsx("input",{type:"number",style:{...v,padding:"8px"},value:g,onChange:c=>x(r,"packSize",c.target.value)})]}),e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{fontSize:"0.65rem",fontWeight:"bold"},children:"Pack Price"}),e.jsx("input",{style:{...v,padding:"8px"},value:C,onChange:c=>x(r,"priceFull",c.target.value)})]})]})]}),e.jsxs("div",{style:{flex:1,backgroundColor:m?"rgba(78, 95, 40, 0.05)":"transparent",padding:"12px",borderRadius:"12px",border:m?"1px solid #4e5f28":"1px solid rgba(28,7,0,0.05)"},children:[e.jsxs("label",{style:{...h,display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",color:m?"#4e5f28":"inherit",marginBottom:m?"12px":0},children:[e.jsx("input",{type:"checkbox",checked:m,onChange:c=>x(r,"hasCapacity",c.target.checked)}),"Limit Max Students"]}),m&&e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.65rem",fontWeight:"bold"},children:"Students Per Session"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"number",style:{...v,padding:"8px 8px 8px 32px"},value:I,onChange:c=>x(r,"capacity",c.target.value)}),e.jsx(pe,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",opacity:.4}})]})]})]})]}),e.jsxs("button",{onClick:()=>D(r,n.text.en),disabled:u,style:{...V,marginTop:"0.5rem",padding:"14px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:[u?e.jsx($,{size:18,className:"spinner"}):e.jsx(st,{size:18}),u?"Saving Updates...":"Save Course Settings"]})]},r)})})]})}function jt({isMobile:y}){const[d,T]=i.useState([]),[R,A]=i.useState([]),[k,N]=i.useState(""),[z,x]=i.useState(""),[D,n]=i.useState(""),r=F(b,"rent_requests"),p=F(b,"rental_availability");i.useEffect(()=>{C();const s=Ee(X(r,ie("createdAt","desc")),c=>{T(c.docs.map(B=>({id:B.id,...B.data()})))}),u=Ee(X(p,ie("date","asc")),c=>{const B=new Date;B.setHours(0,0,0,0);const G=c.docs.map(W=>({id:W.id,...W.data()})).filter(W=>{const q=new Date(W.date);return q.setHours(0,0,0,0),q<B?(Q(P(b,"rental_availability",W.id)),!1):!0});A(G)});return()=>{s(),u()}},[]);const C=async()=>{const s=await Z(F(b,"settings"));if(!s.empty){const u=s.docs.find(c=>c.id==="admin_config");u&&n(u.data().adminEmail||"")}},g=async()=>{try{await ye(P(b,"settings","admin_config"),{adminEmail:D},{merge:!0}),alert("Notification email saved!")}catch(s){alert("Error saving email: "+s.message)}},L=async()=>{if(!k)return alert("Select a date");await fe(p,{date:k,time:z,status:"available"}),N(""),x("")},m=async s=>{await ce(P(b,"rent_requests",s),{status:"approved"})},I=async(s,u)=>{await ce(P(b,"rent_requests",s),{status:"rejected"}),u&&await ce(P(b,"rental_availability",u),{status:"available"})},w=async s=>{window.confirm("Delete this availability?")&&await Q(P(b,"rental_availability",s))},S=async s=>{window.confirm("Delete this request?")&&await Q(P(b,"rent_requests",s))};return e.jsxs("div",{style:{display:y?"block":"flex",gap:"2rem"},children:[e.jsxs("section",{style:{width:y?"100%":"400px"},children:[e.jsxs("div",{style:he,children:[e.jsxs("h3",{style:U,children:[e.jsx(nt,{size:16})," Set Availability"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"date",value:k,onChange:s=>N(s.target.value),style:v}),e.jsx("input",{type:"text",placeholder:"Time slot (e.g. 10:00 - 16:00)",value:z,onChange:s=>x(s.target.value),style:v}),e.jsx("button",{onClick:L,style:{...V,backgroundColor:"#4e5f28",color:"white"},children:"Publish Date"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h4",{style:h,children:"Persistent Notification Email"}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"email",placeholder:"Admin notification email",value:D,onChange:s=>n(s.target.value),style:{...v,flex:1}}),e.jsx("button",{onClick:g,style:{...V,width:"auto",padding:"0 15px"},title:"Save Email to Settings",children:e.jsx(ae,{size:16})})]})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:h,children:"Live Availabilities"}),R.map(s=>e.jsxs("div",{style:{...M,padding:"0.8rem",marginBottom:"0.5rem",opacity:s.status==="available"?1:.5},children:[e.jsxs("span",{style:{fontSize:"0.85rem"},children:[s.date," — ",e.jsx("strong",{children:s.status})]}),e.jsx("button",{onClick:()=>w(s.id),style:ne,children:e.jsx(xe,{size:14})})]},s.id))]})]}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:U,children:[e.jsx(me,{size:16})," Incoming Rent Requests (",d.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:d.map(s=>e.jsxs("div",{style:{...M,alignItems:"flex-start",flexDirection:"column",borderLeft:s.status==="approved"?"6px solid #4e5f28":s.status==="rejected"?"6px solid #ff4d4d":"6px solid #caaff3"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:s.name}),s.status!=="pending"&&e.jsx("span",{style:{fontSize:"0.6rem",background:"#eee",padding:"2px 8px",borderRadius:"100px",textTransform:"uppercase"},children:s.status})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>m(s.id),style:{...ne,color:"#4e5f28",opacity:1},children:e.jsx(it,{size:22})}),e.jsx("button",{onClick:()=>I(s.id,s.availabilityId),style:{...ne,color:"#ff4d4d",opacity:1},children:e.jsx(Pe,{size:22})})]}),e.jsx("a",{href:`mailto:${s.email}`,style:{color:"#caaff3"},children:e.jsx(ae,{size:20})}),e.jsx("button",{onClick:()=>S(s.id),style:ne,children:e.jsx(xe,{size:20})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:y?"1fr":"1fr 1fr",gap:"10px",width:"100%",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:h,children:"Email:"})," ",s.email]}),e.jsxs("div",{children:[e.jsx("span",{style:h,children:"Phone:"})," ",s.phone]}),e.jsxs("div",{children:[e.jsx("span",{style:h,children:"Requested Date:"})," ",e.jsx("strong",{children:s.date})]}),e.jsxs("div",{children:[e.jsx("span",{style:h,children:"Received:"})," ",new Date(s.createdAt).toLocaleDateString()]})]})]},s.id))})]})]})}function bt({isMobile:y,currentLang:d}){const[T,R]=i.useState([]),[A,k]=i.useState(""),[N,z]=i.useState(""),[x,D]=i.useState("free"),[n,r]=i.useState(100),[p,C]=i.useState("uses"),[g,L]=i.useState(1),[m,I]=i.useState(""),[w,S]=i.useState(!1),s=ue.filter(a=>a.type==="courses").flatMap(a=>a.courses||[]).filter(a=>a.link);i.useEffect(()=>{u(),s.length>0&&z(s[0].link)},[]);const u=async()=>{const a=X(F(b,"promo_codes"),ie("createdAt","desc")),G=await Z(a);R(G.docs.map(W=>({id:W.id,...W.data()})))},c=async a=>{a.preventDefault(),S(!0);try{await fe(F(b,"promo_codes"),{code:A.toUpperCase().trim(),coursePath:N,discountType:x,discountValue:x==="free"?100:parseInt(n),limitType:p,maxUses:p==="uses"?parseInt(g):null,expiryDate:p==="date"?m:null,timesUsed:0,createdAt:Me()}),k(""),u()}catch(G){alert("Error creating code: "+G.message)}finally{S(!1)}},B=async a=>{window.confirm("Delete this promo code?")&&(await Q(P(b,"promo_codes",a)),u())};return e.jsxs("div",{style:{display:y?"block":"flex",gap:"2rem"},children:[e.jsx("section",{style:{width:y?"100%":"400px"},children:e.jsxs("div",{style:he,children:[e.jsxs("h3",{style:U,children:[e.jsx(Ne,{size:18})," New Promo Code"]}),e.jsxs("form",{onSubmit:c,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Code Name"}),e.jsx("input",{style:v,placeholder:"e.g. SUMMER24",value:A,onChange:a=>k(a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Apply to Course"}),e.jsx("select",{style:v,value:N,onChange:a=>z(a.target.value),children:s.map(a=>e.jsx("option",{value:a.link,children:a.text[d||"en"]},a.link))})]}),e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Discount Type"}),e.jsxs("div",{style:J,children:[e.jsx("div",{onClick:()=>D("free"),style:{...H,backgroundColor:x==="free"?"#caaff3":"transparent"},children:"Free Session"}),e.jsx("div",{onClick:()=>D("percent"),style:{...H,backgroundColor:x==="percent"?"#caaff3":"transparent"},children:"% Discount"})]})]}),x==="percent"&&e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Discount Percentage (%)"}),e.jsx("input",{style:v,type:"number",min:"1",max:"99",value:n,onChange:a=>r(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Limit By"}),e.jsxs("div",{style:J,children:[e.jsx("div",{onClick:()=>C("uses"),style:{...H,backgroundColor:p==="uses"?"#caaff3":"transparent"},children:"Max Uses"}),e.jsx("div",{onClick:()=>C("date"),style:{...H,backgroundColor:p==="date"?"#caaff3":"transparent"},children:"Expiry Date"})]})]}),p==="uses"?e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Total Number of Uses"}),e.jsx("input",{style:v,type:"number",min:"1",value:g,onChange:a=>L(a.target.value)})]}):e.jsxs("div",{children:[e.jsx("label",{style:h,children:"Valid Until"}),e.jsx("input",{style:v,type:"date",value:m,onChange:a=>I(a.target.value),required:!0})]}),e.jsx("button",{type:"submit",style:V,disabled:w,children:w?"Generating...":"Generate Code"})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:{...U,marginBottom:"1rem"},children:[e.jsx(Re,{size:18})," Active Promotions"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[T.map(a=>e.jsxs("div",{style:{...M,backgroundColor:"#fdf8e1",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"800",fontSize:"1.1rem",color:"#9960a8"},children:a.code}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:a.coursePath}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginTop:"8px",fontSize:"0.85rem"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(at,{size:14})," ",a.discountValue,"% OFF"]}),a.limitType==="uses"?e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(lt,{size:14})," ",a.timesUsed," / ",a.maxUses," used"]}):e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(me,{size:14})," Expires: ",a.expiryDate]})]})]}),e.jsx("button",{onClick:()=>B(a.id),style:{background:"none",border:"none",color:"#ff4d4d",cursor:"pointer"},children:e.jsx(xe,{size:20})})]},a.id)),T.length===0&&e.jsx("p",{style:{opacity:.5},children:"No active codes."})]})]})]})}function Et({currentLang:y,setCurrentLang:d}){const[T,R]=i.useState(null),[A,k]=i.useState(!1),[N,z]=i.useState(!0),[x,D]=i.useState(""),[n,r]=i.useState(""),[p,C]=i.useState(!1),[g,L]=i.useState(window.innerWidth<900),[m,I]=i.useState("events"),[w,S]=i.useState(!1);i.useEffect(()=>{const u=()=>L(window.innerWidth<900);window.addEventListener("resize",u);const c=qe(te,async B=>{if(B)try{const a=await Ie(P(b,"users",B.uid));a.exists()&&a.data().role==="admin"?(R(B),k(!0)):(R(null),k(!1))}catch(a){console.error("Admin check error:",a),R(null),k(!1)}else R(null),k(!1);z(!1)});return()=>{c(),window.removeEventListener("resize",u)}},[]);const s=async u=>{u.preventDefault(),C(!0);try{await Qe(te,x,n)}catch(c){alert("Login failed: "+c.message)}finally{C(!1)}};return N&&!T?e.jsx("div",{style:{...Be,backgroundColor:"#fffce3"},children:e.jsx($,{className:"spinner",size:40,color:"#caaff3"})}):!T||!A?e.jsxs("div",{style:{...Be,backgroundColor:"#fffce3"},children:[e.jsx(we,{currentLang:y,setCurrentLang:d,isMenuOpen:w,onMenuToggle:S}),e.jsxs("form",{onSubmit:s,style:{...xt(g),backgroundColor:"#fdf8e1",border:"1px solid rgba(28, 7, 0, 0.05)",boxShadow:"0 10px 40px rgba(0,0,0,0.03)"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(rt,{size:g?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem",color:"#1c0700"},children:"Atelier Login"})]}),e.jsx("label",{style:h,children:"Email"}),e.jsx("input",{type:"email",value:x,onChange:u=>D(u.target.value),style:{...v,backgroundColor:"rgba(255, 252, 227, 0.4)",border:"1px solid rgba(28, 7, 0, 0.1)",marginBottom:"1.2rem"},required:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:h,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>x&&Ke(te,x),style:ft,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:n,onChange:u=>r(u.target.value),style:{...v,backgroundColor:"rgba(255, 252, 227, 0.4)",border:"1px solid rgba(28, 7, 0, 0.1)",marginBottom:"2rem"},required:!0}),e.jsx("button",{type:"submit",disabled:p,style:V,children:p?e.jsx($,{className:"spinner",size:18}):"Sign In"})]})]}):e.jsxs("div",{style:{padding:g?"100px 1rem 2rem":"140px 4vw 4vw",minHeight:"100vh",fontFamily:"Satoshi",color:"#1c0700",backgroundColor:"#fffce3",display:"flex",flexDirection:"column"},children:[e.jsx(we,{currentLang:y,setCurrentLang:d,isMenuOpen:w,onMenuToggle:S}),e.jsxs("header",{style:{...ut(g),marginBottom:"2rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:g?"2.2rem":"3.5rem",marginBottom:"0.2rem",textTransform:"lowercase"},children:"atelier management"}),e.jsxs("p",{style:{opacity:.5,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"1px"},children:["Admin: ",T.email]})]}),e.jsxs("button",{onClick:()=>Ye(te),style:{...yt,backgroundColor:"#fdf8e1",border:"1px solid rgba(28, 7, 0, 0.1)",borderRadius:"100px",padding:"8px 16px"},children:[e.jsx(ot,{size:16})," ",!g&&"Logout"]})]}),e.jsx("div",{style:{width:"100%",overflowX:"auto",paddingBottom:"10px",marginBottom:"2rem"},children:e.jsxs("nav",{style:{...pt,backgroundColor:"rgba(28, 7, 0, 0.03)",borderRadius:"100px",padding:"4px",display:"inline-flex",minWidth:g?"max-content":"auto"},children:[e.jsxs("button",{onClick:()=>I("events"),style:{...se(),backgroundColor:m==="events"?"#caaff3":"transparent",borderRadius:"100px",color:"#1c0700"},children:[e.jsx(dt,{size:16})," Events"]}),e.jsxs("button",{onClick:()=>I("course-management"),style:{...se(),backgroundColor:m==="course-management"?"#caaff3":"transparent",borderRadius:"100px",color:"#1c0700"},children:[e.jsx(Ae,{size:16})," Course Management"]}),e.jsxs("button",{onClick:()=>I("promotions"),style:{...se(),backgroundColor:m==="promotions"?"#caaff3":"transparent",borderRadius:"100px",color:"#1c0700"},children:[e.jsx(Ne,{size:16})," Promotions"]}),e.jsxs("button",{onClick:()=>I("rental"),style:{...se(),backgroundColor:m==="rental"?"#caaff3":"transparent",borderRadius:"100px",color:"#1c0700"},children:[e.jsx(ct,{size:16})," Rental"]})]})}),e.jsxs("div",{style:{animation:"fadeIn 0.4s ease-out"},children:[m==="events"&&e.jsx(ht,{isMobile:g,currentLang:y}),m==="course-management"&&e.jsx(gt,{isMobile:g}),m==="rental"&&e.jsx(jt,{isMobile:g}),m==="promotions"&&e.jsx(bt,{isMobile:g,currentLang:y})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        /* Hide scrollbar for Chrome, Safari and Opera */
        div::-webkit-scrollbar { display: none; }
      `})]})}export{Et as default};
