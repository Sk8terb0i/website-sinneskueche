import{r as n,j as t}from"./vendor-5u_9lpUi.js";import{p as ie,d as z,a as j}from"./index-DAUfqn8n.js";import{c as re,d as oe,s as le,e as ae,f as Y,h as de,j as ce,k as pe,l as fe,q as ue,o as me,b as xe}from"./vendor-firebase-BIuuo9QM.js";import{L as ge,a as ye,b as he,P as be,C as je,c as ve,d as Se,T as Ce}from"./vendor-icons-Cv3FHBlM.js";import"./vendor-animation-DHy22ush.js";function He(){const[f,G]=n.useState(null),[u,J]=n.useState(""),[D,K]=n.useState(""),[c,L]=n.useState(!1),[T,Q]=n.useState([]),[B,v]=n.useState(""),[I,m]=n.useState(""),[W,x]=n.useState(""),[R,g]=n.useState(""),[a,F]=n.useState("course"),[S,C]=n.useState(""),[h,p]=n.useState(""),[r,P]=n.useState(null),[i,V]=n.useState(window.innerWidth<900),q=re(z,"events"),y=Array.from(new Map(ie.filter(e=>e.type==="courses").flatMap(e=>e.courses||[]).filter(e=>e.link).map(e=>[e.link,e])).values()),k=()=>{y.length>0&&!r&&A(y[0].link)},A=e=>{const s=y.find(o=>o.link===e);C(e),s&&(x(s.text.en),g(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?m("18:30 - 21:30"):m(""))};n.useEffect(()=>{const e=()=>V(window.innerWidth<900);window.addEventListener("resize",e);const s=oe(j,o=>{G(o),o&&(w(),k())});return()=>{s(),window.removeEventListener("resize",e)}},[]);const w=async()=>{try{const e=ue(q,me("date","asc")),s=await xe(e),o=new Date;o.setHours(0,0,0,0);const ne=s.docs.map(b=>({...b.data(),id:b.id})).filter(b=>{const O=new Date(b.date);return O.setHours(0,0,0,0),O>=o});Q(ne)}catch(e){console.error("Error fetching events:",e)}},Z=e=>{P(e.id),v(e.date),m(e.time||""),x(e.title.en),g(e.title.de);const s=e.type||(e.link?.startsWith("http")?"event":"course");F(s),s==="course"?y.some(M=>M.link===e.link)?(C(e.link),p("")):p(e.link):p(e.link||""),document.getElementById("admin-scroll-container")?.scrollTo({top:0,behavior:"smooth"})},E=()=>{P(null),v(""),m(""),p(""),x(""),g(""),a==="course"&&k()},H=e=>{F(e),p(""),e==="course"?k():(C(""),x(""),g(""))},_=async e=>{e.preventDefault();try{const o={date:B,time:I,title:{en:W,de:R},link:a==="event"?h:h||S||"",type:a};r?await ae(Y(z,"events",r),o):await de(q,o),E(),w()}catch(s){alert("Error saving: "+s.message)}},ee=async(e,s)=>{e.stopPropagation(),window.confirm("Delete this entry?")&&(await ce(Y(z,"events",s)),r===s&&E(),w())},te=async e=>{e.preventDefault(),L(!0);try{await pe(j,u,D)}catch(s){alert("Login failed: "+s.message)}finally{L(!1)}},se=async()=>{if(!u||!u.includes("@")){alert("Please enter a valid email address first.");return}try{await fe(j,u),alert("Reset link sent to "+u)}catch(e){alert("Error: "+e.message)}},N=({children:e})=>t.jsx("div",{id:"admin-scroll-container",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",overflowY:"auto",overflowX:"hidden",backgroundColor:"#fffce3",zIndex:9999,fontFamily:"Satoshi",color:"#1c0700"},children:e});return f?t.jsx(N,{children:t.jsxs("div",{style:{padding:i?"1.5rem":"4vw",minHeight:"101vh"},children:[t.jsxs("header",{style:Ee(i),children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:i?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),t.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",f.email]})]}),t.jsxs("button",{onClick:()=>le(j),style:ze,children:[t.jsx(he,{size:16})," ",!i&&"Logout"]})]}),t.jsxs("div",{style:{display:i?"block":"flex",gap:i?"3rem":"4rem",alignItems:"flex-start"},children:[t.jsx("section",{style:{width:i?"100%":"420px",position:i?"relative":"sticky",top:"2rem",marginBottom:i?"3rem":0},children:t.jsxs("div",{style:De,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.2rem"},children:[t.jsxs("h2",{style:{...X,marginBottom:0},children:[r?t.jsx(be,{size:18,color:"#caaff3"}):t.jsx(je,{size:18,color:"#caaff3"}),r?"EDIT ENTRY":"NEW ENTRY"]}),r&&t.jsxs("button",{onClick:E,style:Te,children:[t.jsx(ve,{size:14})," CANCEL"]})]}),t.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Source"}),t.jsxs("div",{style:We,children:[t.jsx("div",{onClick:()=>H("course"),style:{...$,backgroundColor:a==="course"?"#caaff3":"transparent",color:a==="course"?"#fff":"#1c0700"},children:"Course"}),t.jsx("div",{onClick:()=>H("event"),style:{...$,backgroundColor:a==="event"?"#caaff3":"transparent",color:a==="event"?"#fff":"#1c0700"},children:"Event"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Date"}),t.jsx("input",{type:"date",value:B,onChange:e=>v(e.target.value),required:!0,style:l})]}),t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Time"}),t.jsx("input",{type:"text",placeholder:"e.g. 18:30",value:I,onChange:e=>m(e.target.value),style:l})]})]}),a==="course"?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Template"}),t.jsx("select",{value:S,onChange:e=>A(e.target.value),style:l,required:!0,children:y.map((e,s)=>t.jsx("option",{value:e.link,children:e.text.en},s))})]}),t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Override Link"}),t.jsx("input",{type:"url",placeholder:S,value:h,onChange:e=>p(e.target.value),style:l})]})]}):t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Link / URL"}),t.jsx("input",{type:"url",placeholder:"https://...",value:h,onChange:e=>p(e.target.value),style:l})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[t.jsx("input",{type:"text",placeholder:"Title EN",value:W,onChange:e=>x(e.target.value),required:!0,style:l}),t.jsx("input",{type:"text",placeholder:"Title DE",value:R,onChange:e=>g(e.target.value),required:!0,style:l})]}),t.jsx("button",{type:"submit",style:{...U,backgroundColor:r?"#1c0700":"#caaff3",color:r?"#fff":"#1c0700"},children:r?"Update Entry":"Add to Calendar"})]})]})}),t.jsxs("section",{style:{flex:1,width:"100%",paddingBottom:"10vh"},children:[t.jsxs("h2",{style:X,children:[t.jsx(Se,{size:18,color:"#caaff3"})," SCHEDULED (",T.length,")"]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:T.map(e=>t.jsxs("div",{onClick:()=>Z(e),style:{...Be,cursor:"pointer",border:r===e.id?"2px solid #caaff3":"2px solid transparent"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800",marginBottom:"4px"},children:[new Date(e.date).toLocaleDateString("de-DE")," ",e.time&&`â€¢ ${e.time}`]}),t.jsx("span",{style:{fontSize:i?"0.95rem":"1.1rem",fontWeight:"600"},children:e.title.en}),t.jsxs("div",{style:{fontSize:"0.6rem",opacity:.4,marginTop:"4px"},children:["TYPE: ",e.type||"unknown"]})]}),t.jsx("button",{onClick:s=>ee(s,e.id),style:Ie,children:t.jsx(Ce,{size:18})})]},e.id))})]})]})]})}):t.jsx(N,{children:t.jsxs("div",{style:ke,children:[t.jsxs("form",{onSubmit:te,style:we(i),children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[t.jsx(ge,{size:i?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),t.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),t.jsx("label",{style:d,children:"Email"}),t.jsx("input",{type:"email",value:u,onChange:e=>J(e.target.value),style:{...l,marginBottom:"1.2rem"},required:!0,disabled:c}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[t.jsx("label",{style:d,children:"Password"}),t.jsx("button",{type:"button",onClick:se,style:Le,disabled:c,children:"Forgot?"})]}),t.jsx("input",{type:"password",value:D,onChange:e=>K(e.target.value),style:{...l,marginBottom:"2rem"},required:!0,disabled:c}),t.jsx("button",{type:"submit",disabled:c,style:{...U,opacity:c?.7:1,cursor:c?"not-allowed":"pointer",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:c?t.jsxs(t.Fragment,{children:[t.jsx(ye,{className:"spinner",size:18})," Signing In..."]}):"Sign In"})]}),t.jsx("style",{children:`
            .spinner { animation: spin 1s linear infinite; }
            @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
          `})]})})}const ke={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},we=f=>({backgroundColor:"white",padding:f?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),Ee=f=>({marginBottom:f?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),ze={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},De={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},d={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},l={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},U={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},Le={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},X={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},Te={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},Be={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},Ie={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},We={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},$={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{He as default};
