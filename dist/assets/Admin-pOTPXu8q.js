import{r as n,j as e}from"./vendor-5u_9lpUi.js";import{p as ie,d as z,a as j}from"./index-D9SNb_GU.js";import{c as re,d as oe,s as le,e as ae,f as O,h as de,j as ce,k as pe,l as fe,q as ue,o as me,b as xe}from"./vendor-firebase-BIuuo9QM.js";import{L as ge,a as ye,b as he,P as be,C as je,c as ve,d as Se,T as Ce}from"./vendor-icons-Cv3FHBlM.js";import"./vendor-animation-DHy22ush.js";const Y=({children:a})=>e.jsx("div",{id:"admin-scroll-container",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",overflowY:"auto",overflowX:"hidden",backgroundColor:"#fffce3",zIndex:9999,fontFamily:"Satoshi",color:"#1c0700"},children:a});function He(){const[a,G]=n.useState(null),[u,J]=n.useState(""),[D,K]=n.useState(""),[p,L]=n.useState(!1),[T,Q]=n.useState([]),[B,v]=n.useState(""),[I,m]=n.useState(""),[W,x]=n.useState(""),[R,g]=n.useState(""),[d,F]=n.useState("course"),[S,C]=n.useState(""),[h,f]=n.useState(""),[r,P]=n.useState(null),[i,V]=n.useState(window.innerWidth<900),q=re(z,"events"),y=Array.from(new Map(ie.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values()),k=()=>{y.length>0&&!r&&A(y[0].link)},A=t=>{const s=y.find(o=>o.link===t);C(t),s&&(x(s.text.en),g(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?m("18:30 - 21:30"):m(""))};n.useEffect(()=>{const t=()=>V(window.innerWidth<900);window.addEventListener("resize",t);const s=oe(j,o=>{G(o),o&&(w(),k())});return()=>{s(),window.removeEventListener("resize",t)}},[]);const w=async()=>{try{const t=ue(q,me("date","asc")),s=await xe(t),o=new Date;o.setHours(0,0,0,0);const ne=s.docs.map(b=>({...b.data(),id:b.id})).filter(b=>{const M=new Date(b.date);return M.setHours(0,0,0,0),M>=o});Q(ne)}catch(t){console.error("Error fetching events:",t)}},Z=t=>{P(t.id),v(t.date),m(t.time||""),x(t.title.en),g(t.title.de);const s=t.type||(t.link?.startsWith("http")?"event":"course");F(s),s==="course"?y.some(N=>N.link===t.link)?(C(t.link),f("")):f(t.link):f(t.link||""),document.getElementById("admin-scroll-container")?.scrollTo({top:0,behavior:"smooth"})},E=()=>{P(null),v(""),m(""),f(""),x(""),g(""),d==="course"&&k()},H=t=>{F(t),f(""),t==="course"?k():(C(""),x(""),g(""))},_=async t=>{t.preventDefault();try{const o={date:B,time:I,title:{en:W,de:R},link:d==="event"?h:h||S||"",type:d};r?await ae(O(z,"events",r),o):await de(q,o),E(),w()}catch(s){alert("Error saving: "+s.message)}},ee=async(t,s)=>{t.stopPropagation(),window.confirm("Delete this entry?")&&(await ce(O(z,"events",s)),r===s&&E(),w())},te=async t=>{t.preventDefault(),L(!0);try{await pe(j,u,D)}catch(s){alert("Login failed: "+s.message)}finally{L(!1)}},se=async()=>{if(!u||!u.includes("@")){alert("Please enter a valid email address first.");return}try{await fe(j,u),alert("Reset link sent to "+u)}catch(t){alert("Error: "+t.message)}};return a?e.jsx(Y,{children:e.jsxs("div",{style:{padding:i?"1.5rem":"4vw",minHeight:"101vh"},children:[e.jsxs("header",{style:Ee(i),children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:i?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",a.email]})]}),e.jsxs("button",{onClick:()=>le(j),style:ze,children:[e.jsx(he,{size:16})," ",!i&&"Logout"]})]}),e.jsxs("div",{style:{display:i?"block":"flex",gap:i?"3rem":"4rem",alignItems:"flex-start"},children:[e.jsx("section",{style:{width:i?"100%":"420px",position:i?"relative":"sticky",top:"2rem",marginBottom:i?"3rem":0},children:e.jsxs("div",{style:De,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.2rem"},children:[e.jsxs("h2",{style:{...X,marginBottom:0},children:[r?e.jsx(be,{size:18,color:"#caaff3"}):e.jsx(je,{size:18,color:"#caaff3"}),r?"EDIT ENTRY":"NEW ENTRY"]}),r&&e.jsxs("button",{onClick:E,style:Te,children:[e.jsx(ve,{size:14})," CANCEL"]})]}),e.jsxs("form",{onSubmit:_,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Source"}),e.jsxs("div",{style:We,children:[e.jsx("div",{onClick:()=>H("course"),style:{...$,backgroundColor:d==="course"?"#caaff3":"transparent",color:d==="course"?"#fff":"#1c0700"},children:"Course"}),e.jsx("div",{onClick:()=>H("event"),style:{...$,backgroundColor:d==="event"?"#caaff3":"transparent",color:d==="event"?"#fff":"#1c0700"},children:"Event"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Date"}),e.jsx("input",{type:"date",value:B,onChange:t=>v(t.target.value),required:!0,style:l})]}),e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Time"}),e.jsx("input",{type:"text",placeholder:"e.g. 18:30",value:I,onChange:t=>m(t.target.value),style:l})]})]}),d==="course"?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Template"}),e.jsx("select",{value:S,onChange:t=>A(t.target.value),style:l,required:!0,children:y.map((t,s)=>e.jsx("option",{value:t.link,children:t.text.en},s))})]}),e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Override Link"}),e.jsx("input",{type:"url",placeholder:S,value:h,onChange:t=>f(t.target.value),style:l})]})]}):e.jsxs("div",{children:[e.jsx("label",{style:c,children:"Link / URL"}),e.jsx("input",{type:"url",placeholder:"https://...",value:h,onChange:t=>f(t.target.value),style:l})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Title EN",value:W,onChange:t=>x(t.target.value),required:!0,style:l}),e.jsx("input",{type:"text",placeholder:"Title DE",value:R,onChange:t=>g(t.target.value),required:!0,style:l})]}),e.jsx("button",{type:"submit",style:{...U,backgroundColor:r?"#1c0700":"#caaff3",color:r?"#fff":"#1c0700"},children:r?"Update Entry":"Add to Calendar"})]})]})}),e.jsxs("section",{style:{flex:1,width:"100%",paddingBottom:"10vh"},children:[e.jsxs("h2",{style:X,children:[e.jsx(Se,{size:18,color:"#caaff3"})," SCHEDULED (",T.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:T.map(t=>e.jsxs("div",{onClick:()=>Z(t),style:{...Be,cursor:"pointer",border:r===t.id?"2px solid #caaff3":"2px solid transparent"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800",marginBottom:"4px"},children:[new Date(t.date).toLocaleDateString("de-DE")," ",t.time&&`â€¢ ${t.time}`]}),e.jsx("span",{style:{fontSize:i?"0.95rem":"1.1rem",fontWeight:"600"},children:t.title.en}),e.jsxs("div",{style:{fontSize:"0.6rem",opacity:.4,marginTop:"4px"},children:["TYPE: ",t.type||"unknown"]})]}),e.jsx("button",{onClick:s=>ee(s,t.id),style:Ie,children:e.jsx(Ce,{size:18})})]},t.id))})]})]})]})}):e.jsx(Y,{children:e.jsxs("div",{style:ke,children:[e.jsxs("form",{onSubmit:te,style:we(i),children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(ge,{size:i?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),e.jsx("label",{style:c,children:"Email"}),e.jsx("input",{type:"email",value:u,onChange:t=>J(t.target.value),style:{...l,marginBottom:"1.2rem"},required:!0,disabled:p}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:c,children:"Password"}),e.jsx("button",{type:"button",onClick:se,style:Le,disabled:p,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:D,onChange:t=>K(t.target.value),style:{...l,marginBottom:"2rem"},required:!0,disabled:p}),e.jsx("button",{type:"submit",disabled:p,style:{...U,opacity:p?.7:1,cursor:p?"not-allowed":"pointer",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:p?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"spinner",size:18})," Signing In..."]}):"Sign In"})]}),e.jsx("style",{children:`
            .spinner { animation: spin 1s linear infinite; }
            @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
          `})]})})}const ke={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},we=a=>({backgroundColor:"white",padding:a?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),Ee=a=>({marginBottom:a?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),ze={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},De={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},c={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},l={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},U={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},Le={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},X={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},Te={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},Be={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},Ie={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},We={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},$={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{He as default};
