import{r as i,j as e}from"./vendor-5u_9lpUi.js";import{p as Fe,d as n,a as b}from"./index-BtJYeYx6.js";import{c as S,h as Ne,s as Pe,j as _e,k as L,f as c,l as ae,q as A,o as B,b as oe,e as re,u as I,m as qe,d as de}from"./vendor-firebase-CmSCscF-.js";import{L as Me,g as He,h as Oe,i as ce,d as Ye,T as W,j as Ue,k as pe,C as Xe,l as $e}from"./vendor-icons-CgpCK4uI.js";import"./vendor-animation-DHy22ush.js";const xe=({children:d})=>e.jsx("div",{id:"admin-scroll-container",style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",overflowY:"auto",overflowX:"hidden",backgroundColor:"#fffce3",zIndex:9999,fontFamily:"Satoshi",color:"#1c0700"},children:d});function at(){const[d,ye]=i.useState(null),[w,he]=i.useState(""),[N,fe]=i.useState(""),[P,_]=i.useState(!1),[l,ge]=i.useState(window.innerWidth<900),[q,je]=i.useState([]),[M,k]=i.useState(""),[H,m]=i.useState(""),[O,g]=i.useState(""),[Y,j]=i.useState(""),[p,E]=i.useState("course"),[U,X]=i.useState(""),[z,y]=i.useState(""),[x,$]=i.useState(null),[D,ve]=i.useState([]),[be,Se]=i.useState([]),[T,G]=i.useState(""),[J,K]=i.useState(""),[Q,V]=i.useState(""),Z=S(n,"events"),Ce=S(n,"rent_requests"),ee=S(n,"rental_availability"),h=Array.from(new Map(Fe.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values());i.useEffect(()=>{const t=()=>ge(window.innerWidth<900);window.addEventListener("resize",t);const s=Ne(b,a=>{ye(a),a&&(R(),te(),we(),ke())});return()=>{s(),window.removeEventListener("resize",t)}},[]);const we=()=>{de(A(Ce,B("createdAt","desc")),t=>{ve(t.docs.map(s=>({id:s.id,...s.data()})))}),de(A(ee,B("date","asc")),t=>{Se(t.docs.map(s=>({id:s.id,...s.data()})))})},ke=async()=>{const t=await oe(S(n,"settings"));t.empty||V(t.docs[0].data().adminEmail||"")},Ee=async()=>{await ae(c(n,"settings","admin_config"),{adminEmail:Q},{merge:!0}),alert("Notification email updated!")},R=async()=>{try{const t=A(Z,B("date","asc")),s=await oe(t),a=new Date;a.setHours(0,0,0,0);const We=s.docs.map(v=>({...v.data(),id:v.id})).filter(v=>{const le=new Date(v.date);return le.setHours(0,0,0,0),le>=a});je(We)}catch(t){console.error("Error fetching events:",t)}},te=()=>{h.length>0&&!x&&se(h[0].link)},se=t=>{const s=h.find(a=>a.link===t);X(t),s&&(g(s.text.en),j(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?m("18:30 - 21:30"):m(""))},ze=async t=>{t.preventDefault();try{const a={date:M,time:H,title:{en:O,de:Y},link:p==="event"?z:z||U||"",type:p};x?await ae(c(n,"events",x),a):await re(Z,a),ie(),R()}catch(s){alert("Error saving: "+s.message)}},De=async()=>{if(!T)return alert("Select a date");await re(ee,{date:T,time:J,status:"available"}),G(""),K("")},Te=async t=>{await I(c(n,"rent_requests",t),{status:"approved"})},Re=async(t,s)=>{await I(c(n,"rent_requests",t),{status:"rejected"}),s&&await I(c(n,"rental_availability",s),{status:"available"})},Le=async t=>{window.confirm("Delete this availability?")&&await L(c(n,"rental_availability",t))},Ae=async t=>{window.confirm("Delete this request?")&&await L(c(n,"rent_requests",t))},Be=t=>{$(t.id),k(t.date),m(t.time||""),g(t.title.en),j(t.title.de);const s=t.type||(t.link?.startsWith("http")?"event":"course");E(s),s==="course"?h.some(ne=>ne.link===t.link)?(X(t.link),y("")):y(t.link):y(t.link||""),document.getElementById("admin-scroll-container")?.scrollTo({top:0,behavior:"smooth"})},ie=()=>{$(null),k(""),m(""),y(""),g(""),j(""),p==="course"&&te()},Ie=async t=>{t.preventDefault(),_(!0);try{await qe(b,w,N)}catch(s){alert("Login failed: "+s.message)}finally{_(!1)}};return d?e.jsx(xe,{children:e.jsxs("div",{style:{padding:l?"1.5rem":"4vw",minHeight:"101vh"},children:[e.jsxs("header",{style:Ke(l),children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:l?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",d.email]})]}),e.jsxs("button",{onClick:()=>_e(b),style:Qe,children:[e.jsx(Oe,{size:16})," ",!l&&"Logout"]})]}),e.jsx("h2",{style:{...u,color:"#4e5f28",fontSize:"1.2rem"},children:"1. Calendar Events"}),e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem",marginBottom:"5rem"},children:[e.jsx("section",{style:{width:l?"100%":"400px"},children:e.jsxs("div",{style:ue,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.2rem"},children:[e.jsx("h3",{style:u,children:x?"EDIT ENTRY":"NEW ENTRY"}),x&&e.jsxs("button",{onClick:ie,style:Ze,children:[e.jsx(ce,{size:14})," CANCEL"]})]}),e.jsxs("form",{onSubmit:ze,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:r,children:"Source"}),e.jsxs("div",{style:et,children:[e.jsx("div",{onClick:()=>E("course"),style:{...me,backgroundColor:p==="course"?"#caaff3":"transparent"},children:"Course"}),e.jsx("div",{onClick:()=>E("event"),style:{...me,backgroundColor:p==="event"?"#caaff3":"transparent"},children:"Event"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"date",value:M,onChange:t=>k(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Time",value:H,onChange:t=>m(t.target.value),style:o})]}),p==="course"?e.jsx("select",{value:U,onChange:t=>se(t.target.value),style:o,required:!0,children:h.map((t,s)=>e.jsx("option",{value:t.link,children:t.text.en},s))}):e.jsx("input",{type:"url",placeholder:"URL https://...",value:z,onChange:t=>y(t.target.value),style:o}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Title EN",value:O,onChange:t=>g(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Title DE",value:Y,onChange:t=>j(t.target.value),required:!0,style:o})]}),e.jsx("button",{type:"submit",style:C,children:x?"Update Entry":"Add to Calendar"})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:u,children:[e.jsx(Ye,{size:16})," Scheduled Events (",q.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:q.map(t=>e.jsxs("div",{onClick:()=>Be(t),style:F,children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800"},children:[t.date," ",t.time&&`• ${t.time}`]}),e.jsx("span",{style:{fontWeight:"600"},children:t.title.en})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),window.confirm("Delete?")&&L(c(n,"events",t.id)).then(R)},style:f,children:e.jsx(W,{size:18})})]},t.id))})]})]}),e.jsx("hr",{style:{opacity:.1,marginBottom:"4rem"}}),e.jsx("h2",{style:{...u,color:"#4e5f28",fontSize:"1.2rem"},children:"2. Rental Management"}),e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem"},children:[e.jsxs("section",{style:{width:l?"100%":"400px"},children:[e.jsxs("div",{style:ue,children:[e.jsxs("h3",{style:u,children:[e.jsx(Ue,{size:16})," Set Availability"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"date",value:T,onChange:t=>G(t.target.value),style:o}),e.jsx("input",{type:"text",placeholder:"Time slot (e.g. 10:00 - 16:00)",value:J,onChange:t=>K(t.target.value),style:o}),e.jsx("button",{onClick:De,style:{...C,backgroundColor:"#4e5f28",color:"white"},children:"Publish Date"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h4",{style:r,children:"Notification Settings"}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"email",placeholder:"Admin notification email",value:Q,onChange:t=>V(t.target.value),style:{...o,flex:1}}),e.jsx("button",{onClick:Ee,style:{...C,width:"auto",padding:"0 15px"},children:e.jsx(pe,{size:16})})]})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:r,children:"Live Availabilities"}),be.map(t=>e.jsxs("div",{style:{...F,padding:"0.8rem",marginBottom:"0.5rem",opacity:t.status==="available"?1:.5},children:[e.jsxs("span",{style:{fontSize:"0.85rem"},children:[t.date," — ",e.jsx("strong",{children:t.status})]}),e.jsx("button",{onClick:()=>Le(t.id),style:f,children:e.jsx(W,{size:14})})]},t.id))]})]}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:u,children:[e.jsx(Xe,{size:16})," Incoming Rent Requests (",D.length,")"]}),D.length===0&&e.jsx("p",{style:{opacity:.5},children:"No requests yet."}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:D.map(t=>e.jsxs("div",{style:{...F,alignItems:"flex-start",flexDirection:"column",borderLeft:t.status==="approved"?"6px solid #4e5f28":t.status==="rejected"?"6px solid #ff4d4d":"6px solid #caaff3"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:t.name}),t.status!=="pending"&&e.jsx("span",{style:{fontSize:"0.6rem",background:"#eee",padding:"2px 8px",borderRadius:"10px",textTransform:"uppercase"},children:t.status})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Te(t.id),title:"Approve",style:{...f,color:"#4e5f28",opacity:1},children:e.jsx($e,{size:22})}),e.jsx("button",{onClick:()=>Re(t.id,t.availabilityId),title:"Reject",style:{...f,color:"#ff4d4d",opacity:1},children:e.jsx(ce,{size:22})})]}),e.jsx("a",{href:`mailto:${t.email}`,style:{color:"#caaff3"},children:e.jsx(pe,{size:20})}),e.jsx("button",{onClick:()=>Ae(t.id),style:f,children:e.jsx(W,{size:20})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:l?"1fr":"1fr 1fr",gap:"10px",width:"100%",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Email:"})," ",t.email]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Phone:"})," ",t.phone]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Requested Date:"})," ",e.jsx("strong",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{style:r,children:"Received:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]},t.id))})]})]})]})}):e.jsx(xe,{children:e.jsx("div",{style:Ge,children:e.jsxs("form",{onSubmit:Ie,style:Je(l),children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(Me,{size:l?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),e.jsx("label",{style:r,children:"Email"}),e.jsx("input",{type:"email",value:w,onChange:t=>he(t.target.value),style:{...o,marginBottom:"1.2rem"},required:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:r,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>Pe(b,w),style:Ve,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:N,onChange:t=>fe(t.target.value),style:{...o,marginBottom:"2rem"},required:!0}),e.jsx("button",{type:"submit",disabled:P,style:C,children:P?e.jsx(He,{className:"spinner",size:18}):"Sign In"})]})})})}const Ge={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},Je=d=>({backgroundColor:"white",padding:d?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),Ke=d=>({marginBottom:d?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),Qe={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},ue={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},r={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},o={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},C={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},Ve={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},u={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},Ze={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},F={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},f={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},et={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},me={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{at as default};
