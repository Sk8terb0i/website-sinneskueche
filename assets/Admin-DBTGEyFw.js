import{r as i,j as e}from"./vendor-yu5OYTCw.js";import{p as We,d as a,a as w}from"./index-Czk0BulT.js";import{c as k,h as Fe,s as Ne,j as _e,k as j,f as r,l as oe,q as I,o as W,b as re,e as de,u as F,m as qe,d as ce}from"./vendor-firebase-C2tt4pnL.js";import{n as Pe,o as He,p as Me,q as pe,f as Oe,T as N,r as Ue,s as ue,C as Ye,t as $e}from"./vendor-icons-CauZMkIs.js";import"./vendor-animation-Duxi266C.js";function at(){const[u,ye]=i.useState(null),[z,he]=i.useState(""),[q,fe]=i.useState(""),[P,H]=i.useState(!1),[l,ge]=i.useState(window.innerWidth<900),[M,je]=i.useState([]),[O,D]=i.useState(""),[U,h]=i.useState(""),[Y,v]=i.useState(""),[$,S]=i.useState(""),[x,T]=i.useState("course"),[X,G]=i.useState(""),[R,f]=i.useState(""),[m,J]=i.useState(null),[L,be]=i.useState([]),[ve,Se]=i.useState([]),[A,K]=i.useState(""),[Q,V]=i.useState(""),[Z,ee]=i.useState(""),te=k(a,"events"),Ce=k(a,"rent_requests"),se=k(a,"rental_availability"),g=Array.from(new Map(We.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values());i.useEffect(()=>{const t=()=>ge(window.innerWidth<900);window.addEventListener("resize",t);const s=Fe(w,n=>{ye(n),n&&(B(),ie(),we(),ke())});return()=>{s(),window.removeEventListener("resize",t)}},[]);const we=()=>{ce(I(Ce,W("createdAt","desc")),t=>{be(t.docs.map(s=>({id:s.id,...s.data()})))}),ce(I(se,W("date","asc")),t=>{const s=new Date;s.setHours(0,0,0,0);const C=t.docs.map(p=>({id:p.id,...p.data()})).filter(p=>{const c=new Date(p.date);return c.setHours(0,0,0,0),c<s?(j(r(a,"rental_availability",p.id)),!1):!0});Se(C)})},ke=async()=>{const t=await re(k(a,"settings"));if(!t.empty){const s=t.docs.find(n=>n.id==="admin_config");s&&ee(s.data().adminEmail||"")}},Ee=async()=>{try{await oe(r(a,"settings","admin_config"),{adminEmail:Z},{merge:!0}),alert("Notification email saved!")}catch(t){alert("Error saving email: "+t.message)}},B=async()=>{try{const t=I(te,W("date","asc")),s=await re(t),n=new Date;n.setHours(0,0,0,0);const p=s.docs.map(c=>({...c.data(),id:c.id})).filter(c=>{const le=new Date(c.date);return le.setHours(0,0,0,0),le<n?(j(r(a,"events",c.id)),!1):!0});je(p)}catch(t){console.error("Error fetching events:",t)}},ie=()=>{g.length>0&&!m&&ne(g[0].link)},ne=t=>{const s=g.find(n=>n.link===t);G(t),s&&(v(s.text.en),S(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?h("18:30 - 21:30"):h(""))},ze=async t=>{t.preventDefault();try{const n={date:O,time:U,title:{en:Y,de:$},link:x==="event"?R:R||X||"",type:x};m?await oe(r(a,"events",m),n):await de(te,n),ae(),B()}catch(s){alert("Error saving: "+s.message)}},De=async()=>{if(!A)return alert("Select a date");await de(se,{date:A,time:Q,status:"available"}),K(""),V("")},Te=async t=>{await F(r(a,"rent_requests",t),{status:"approved"})},Re=async(t,s)=>{await F(r(a,"rent_requests",t),{status:"rejected"}),s&&await F(r(a,"rental_availability",s),{status:"available"})},Le=async t=>{window.confirm("Delete this availability?")&&await j(r(a,"rental_availability",t))},Ae=async t=>{window.confirm("Delete this request?")&&await j(r(a,"rent_requests",t))},Be=t=>{J(t.id),D(t.date),h(t.time||""),v(t.title.en),S(t.title.de);const s=t.type||(t.link?.startsWith("http")?"event":"course");T(s),s==="course"?g.some(C=>C.link===t.link)?(G(t.link),f("")):f(t.link):f(t.link||""),window.scrollTo({top:0,behavior:"smooth"})},ae=()=>{J(null),D(""),h(""),f(""),v(""),S(""),x==="course"&&ie()},Ie=async t=>{t.preventDefault(),H(!0);try{await qe(w,z,q)}catch(s){alert("Login failed: "+s.message)}finally{H(!1)}};return u?e.jsxs("div",{style:{padding:l?"1.5rem":"4vw",minHeight:"100vh",fontFamily:"Satoshi",color:"#1c0700"},children:[e.jsxs("header",{style:Je(l),children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:l?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",u.email]})]}),e.jsxs("button",{onClick:()=>_e(w),style:Ke,children:[e.jsx(Me,{size:16})," ",!l&&"Logout"]})]}),e.jsx("h2",{style:{...y,color:"#4e5f28",fontSize:"1.2rem"},children:"1. Calendar Events"}),e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem",marginBottom:"5rem"},children:[e.jsx("section",{style:{width:l?"100%":"400px"},children:e.jsxs("div",{style:xe,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.2rem"},children:[e.jsx("h3",{style:y,children:m?"EDIT ENTRY":"NEW ENTRY"}),m&&e.jsxs("button",{onClick:ae,style:Ve,children:[e.jsx(pe,{size:14})," CANCEL"]})]}),e.jsxs("form",{onSubmit:ze,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:d,children:"Source"}),e.jsxs("div",{style:Ze,children:[e.jsx("div",{onClick:()=>T("course"),style:{...me,backgroundColor:x==="course"?"#caaff3":"transparent"},children:"Course"}),e.jsx("div",{onClick:()=>T("event"),style:{...me,backgroundColor:x==="event"?"#caaff3":"transparent"},children:"Event"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"date",value:O,onChange:t=>D(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Time",value:U,onChange:t=>h(t.target.value),style:o})]}),x==="course"?e.jsx("select",{value:X,onChange:t=>ne(t.target.value),style:o,required:!0,children:g.map((t,s)=>e.jsx("option",{value:t.link,children:t.text.en},s))}):e.jsx("input",{type:"url",placeholder:"URL https://...",value:R,onChange:t=>f(t.target.value),style:o}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Title EN",value:Y,onChange:t=>v(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Title DE",value:$,onChange:t=>S(t.target.value),required:!0,style:o})]}),e.jsx("button",{type:"submit",style:E,children:m?"Update Entry":"Add to Calendar"})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:y,children:[e.jsx(Oe,{size:16})," Scheduled Events (",M.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:M.map(t=>e.jsxs("div",{onClick:()=>Be(t),style:_,children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800"},children:[t.date," ",t.time&&`• ${t.time}`]}),e.jsx("span",{style:{fontWeight:"600"},children:t.title.en})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),window.confirm("Delete?")&&j(r(a,"events",t.id)).then(B)},style:b,children:e.jsx(N,{size:18})})]},t.id))})]})]}),e.jsx("hr",{style:{opacity:.1,marginBottom:"4rem"}}),e.jsx("h2",{style:{...y,color:"#4e5f28",fontSize:"1.2rem"},children:"2. Rental Management"}),e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem"},children:[e.jsxs("section",{style:{width:l?"100%":"400px"},children:[e.jsxs("div",{style:xe,children:[e.jsxs("h3",{style:y,children:[e.jsx(Ue,{size:16})," Set Availability"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"date",value:A,onChange:t=>K(t.target.value),style:o}),e.jsx("input",{type:"text",placeholder:"Time slot (e.g. 10:00 - 16:00)",value:Q,onChange:t=>V(t.target.value),style:o}),e.jsx("button",{onClick:De,style:{...E,backgroundColor:"#4e5f28",color:"white"},children:"Publish Date"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h4",{style:d,children:"Persistent Notification Email"}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"email",placeholder:"Admin notification email",value:Z,onChange:t=>ee(t.target.value),style:{...o,flex:1}}),e.jsx("button",{onClick:Ee,style:{...E,width:"auto",padding:"0 15px"},title:"Save Email to Settings",children:e.jsx(ue,{size:16})})]}),e.jsx("p",{style:{fontSize:"0.7rem",opacity:.5,marginTop:"5px"},children:"Requests will be sent to this email until changed."})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:d,children:"Live Availabilities"}),ve.map(t=>e.jsxs("div",{style:{..._,padding:"0.8rem",marginBottom:"0.5rem",opacity:t.status==="available"?1:.5},children:[e.jsxs("span",{style:{fontSize:"0.85rem"},children:[t.date," — ",e.jsx("strong",{children:t.status})]}),e.jsx("button",{onClick:()=>Le(t.id),style:b,children:e.jsx(N,{size:14})})]},t.id))]})]}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:y,children:[e.jsx(Ye,{size:16})," Incoming Rent Requests (",L.length,")"]}),L.length===0&&e.jsx("p",{style:{opacity:.5},children:"No requests yet."}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:L.map(t=>e.jsxs("div",{style:{..._,alignItems:"flex-start",flexDirection:"column",borderLeft:t.status==="approved"?"6px solid #4e5f28":t.status==="rejected"?"6px solid #ff4d4d":"6px solid #caaff3"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:t.name}),t.status!=="pending"&&e.jsx("span",{style:{fontSize:"0.6rem",background:"#eee",padding:"2px 8px",borderRadius:"100px",textTransform:"uppercase"},children:t.status})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Te(t.id),style:{...b,color:"#4e5f28",opacity:1},children:e.jsx($e,{size:22})}),e.jsx("button",{onClick:()=>Re(t.id,t.availabilityId),style:{...b,color:"#ff4d4d",opacity:1},children:e.jsx(pe,{size:22})})]}),e.jsx("a",{href:`mailto:${t.email}`,style:{color:"#caaff3"},children:e.jsx(ue,{size:20})}),e.jsx("button",{onClick:()=>Ae(t.id),style:b,children:e.jsx(N,{size:20})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:l?"1fr":"1fr 1fr",gap:"10px",width:"100%",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Email:"})," ",t.email]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Phone:"})," ",t.phone]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Requested Date:"})," ",e.jsx("strong",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Received:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]},t.id))})]})]})]}):e.jsx("div",{style:Xe,children:e.jsxs("form",{onSubmit:Ie,style:Ge(l),children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(Pe,{size:l?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),e.jsx("label",{style:d,children:"Email"}),e.jsx("input",{type:"email",value:z,onChange:t=>he(t.target.value),style:{...o,marginBottom:"1.2rem"},required:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:d,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>Ne(w,z),style:Qe,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:q,onChange:t=>fe(t.target.value),style:{...o,marginBottom:"2rem"},required:!0}),e.jsx("button",{type:"submit",disabled:P,style:E,children:P?e.jsx(He,{className:"spinner",size:18}):"Sign In"})]})})}const Xe={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},Ge=u=>({backgroundColor:"white",padding:u?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),Je=u=>({marginBottom:u?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),Ke={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},xe={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},d={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},o={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},E={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},Qe={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},y={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},Ve={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},_={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},b={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},Ze={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},me={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{at as default};
