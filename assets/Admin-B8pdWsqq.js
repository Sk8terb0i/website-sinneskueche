import{r as n,j as t}from"./vendor-5u_9lpUi.js";import{p as ne,d as L,a as j}from"./index-CppwLzqb.js";import{c as ie,d as re,s as oe,e as le,f as O,h as ae,j as de,k as ce,l as pe,q as fe,o as ue,b as me}from"./vendor-firebase-BIuuo9QM.js";import{L as xe,a as ge,b as ye,P as he,C as be,c as je,d as ve,T as Se}from"./vendor-icons-Cv3FHBlM.js";import"./vendor-animation-DHy22ush.js";function qe(){const[f,$]=n.useState(null),[u,G]=n.useState(""),[z,J]=n.useState(""),[c,D]=n.useState(!1),[T,K]=n.useState([]),[B,v]=n.useState(""),[I,m]=n.useState(""),[R,x]=n.useState(""),[W,g]=n.useState(""),[a,F]=n.useState("course"),[S,C]=n.useState(""),[h,p]=n.useState(""),[r,P]=n.useState(null),[i,Q]=n.useState(window.innerWidth<900),q=ie(L,"events"),y=Array.from(new Map(ne.filter(e=>e.type==="courses").flatMap(e=>e.courses||[]).filter(e=>e.link).map(e=>[e.link,e])).values()),k=()=>{y.length>0&&!r&&A(y[0].link)},A=e=>{const s=y.find(o=>o.link===e);C(e),s&&(x(s.text.en),g(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?m("18:30 - 21:30"):m(""))};n.useEffect(()=>{const e=()=>Q(window.innerWidth<900);window.addEventListener("resize",e);const s=re(j,o=>{$(o),o&&(w(),k())});return()=>{s(),window.removeEventListener("resize",e)}},[]);const w=async()=>{try{const e=fe(q,ue("date","asc")),s=await me(e),o=new Date;o.setHours(0,0,0,0);const se=s.docs.map(b=>({...b.data(),id:b.id})).filter(b=>{const M=new Date(b.date);return M.setHours(0,0,0,0),M>=o});K(se)}catch(e){console.error("Error fetching events:",e)}},V=e=>{P(e.id),v(e.date),m(e.time||""),x(e.title.en),g(e.title.de);const s=e.type||(e.link?.startsWith("http")?"event":"course");F(s),s==="course"?y.some(N=>N.link===e.link)?(C(e.link),p("")):p(e.link):p(e.link||""),window.scrollTo({top:0,behavior:"smooth"})},E=()=>{P(null),v(""),m(""),p(""),x(""),g(""),a==="course"&&k()},H=e=>{F(e),p(""),e==="course"?k():(C(""),x(""),g(""))},Z=async e=>{e.preventDefault();try{const o={date:B,time:I,title:{en:R,de:W},link:a==="event"?h:h||S||"",type:a};r?await le(O(L,"events",r),o):await ae(q,o),E(),w()}catch(s){alert("Error saving: "+s.message)}},_=async(e,s)=>{e.stopPropagation(),window.confirm("Delete this entry?")&&(await de(O(L,"events",s)),r===s&&E(),w())},ee=async e=>{e.preventDefault(),D(!0);try{await ce(j,u,z)}catch(s){alert("Login failed: "+s.message)}finally{D(!1)}},te=async()=>{if(!u||!u.includes("@")){alert("Please enter a valid email address first.");return}try{await pe(j,u),alert("Reset link sent to "+u)}catch(e){alert("Error: "+e.message)}};return f?t.jsx("div",{style:{width:"100%",minHeight:"100vh",backgroundColor:"#fffce3",color:"#1c0700",fontFamily:"Satoshi",overflowX:"hidden"},children:t.jsxs("div",{style:{padding:i?"1.5rem":"4vw"},children:[t.jsxs("header",{style:we(i),children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:i?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),t.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",f.email]})]}),t.jsxs("button",{onClick:()=>oe(j),style:Ee,children:[t.jsx(ye,{size:16})," ",!i&&"Logout"]})]}),t.jsxs("div",{style:{display:i?"block":"flex",gap:i?"3rem":"4rem",alignItems:"flex-start"},children:[t.jsx("section",{style:{width:i?"100%":"420px",position:i?"relative":"sticky",top:"2rem",marginBottom:i?"3rem":0},children:t.jsxs("div",{style:Le,children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.2rem"},children:[t.jsxs("h2",{style:{...Y,marginBottom:0},children:[r?t.jsx(he,{size:18,color:"#caaff3"}):t.jsx(be,{size:18,color:"#caaff3"}),r?"EDIT ENTRY":"NEW ENTRY"]}),r&&t.jsxs("button",{onClick:E,style:{background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},children:[t.jsx(je,{size:14})," CANCEL"]})]}),t.jsxs("form",{onSubmit:Z,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Source"}),t.jsxs("div",{style:Be,children:[t.jsx("div",{onClick:()=>H("course"),style:{...X,backgroundColor:a==="course"?"#caaff3":"transparent",color:a==="course"?"#fff":"#1c0700"},children:"Course"}),t.jsx("div",{onClick:()=>H("event"),style:{...X,backgroundColor:a==="event"?"#caaff3":"transparent",color:a==="event"?"#fff":"#1c0700"},children:"Event"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Date"}),t.jsx("input",{type:"date",value:B,onChange:e=>v(e.target.value),required:!0,style:l})]}),t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Time"}),t.jsx("input",{type:"text",placeholder:"e.g. 18:30",value:I,onChange:e=>m(e.target.value),style:l})]})]}),a==="course"?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Template"}),t.jsx("select",{value:S,onChange:e=>A(e.target.value),style:l,required:!0,children:y.map((e,s)=>t.jsx("option",{value:e.link,children:e.text.en},s))})]}),t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Override Link (Custom URL)"}),t.jsx("input",{type:"url",placeholder:S,value:h,onChange:e=>p(e.target.value),style:l})]})]}):t.jsxs("div",{children:[t.jsx("label",{style:d,children:"Link / URL"}),t.jsx("input",{type:"url",placeholder:"https://...",value:h,onChange:e=>p(e.target.value),style:l})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[t.jsx("input",{type:"text",placeholder:"Title EN",value:R,onChange:e=>x(e.target.value),required:!0,style:l}),t.jsx("input",{type:"text",placeholder:"Title DE",value:W,onChange:e=>g(e.target.value),required:!0,style:l})]}),t.jsx("button",{type:"submit",style:{...U,backgroundColor:r?"#1c0700":"#caaff3",color:r?"#fff":"#1c0700"},children:r?"Update Entry":"Add to Calendar"})]})]})}),t.jsxs("section",{style:{flex:1,width:"100%",paddingBottom:"10vh"},children:[t.jsxs("h2",{style:Y,children:[t.jsx(ve,{size:18,color:"#caaff3"})," SCHEDULED (",T.length,")"]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:T.map(e=>t.jsxs("div",{onClick:()=>V(e),style:{...De,cursor:"pointer",border:r===e.id?"2px solid #caaff3":"2px solid transparent"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800",marginBottom:"4px"},children:[new Date(e.date).toLocaleDateString("de-DE")," ",e.time&&`â€¢ ${e.time}`]}),t.jsx("span",{style:{fontSize:i?"0.95rem":"1.1rem",fontWeight:"600"},children:e.title.en}),t.jsxs("div",{style:{fontSize:"0.6rem",opacity:.4,marginTop:"4px"},children:["TYPE: ",e.type||"unknown"]})]}),t.jsx("button",{onClick:s=>_(s,e.id),style:Te,children:t.jsx(Se,{size:18})})]},e.id))})]})]})]})}):t.jsxs("div",{style:Ce,children:[t.jsxs("form",{onSubmit:ee,style:ke(i),children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[t.jsx(xe,{size:i?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),t.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),t.jsx("label",{style:d,children:"Email"}),t.jsx("input",{type:"email",value:u,onChange:e=>G(e.target.value),style:{...l,marginBottom:"1.2rem"},required:!0,disabled:c}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[t.jsx("label",{style:d,children:"Password"}),t.jsx("button",{type:"button",onClick:te,style:ze,disabled:c,children:"Forgot?"})]}),t.jsx("input",{type:"password",value:z,onChange:e=>J(e.target.value),style:{...l,marginBottom:"2rem"},required:!0,disabled:c}),t.jsx("button",{type:"submit",disabled:c,style:{...U,opacity:c?.7:1,cursor:c?"not-allowed":"pointer",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:c?t.jsxs(t.Fragment,{children:[t.jsx(ge,{className:"spinner",size:18})," Signing In..."]}):"Sign In"})]}),t.jsx("style",{children:`
          .spinner {
            animation: spin 1s linear infinite;
          }
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Ce={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",backgroundColor:"#fffce3",padding:"1.5rem"},ke=f=>({backgroundColor:"white",padding:f?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),we=f=>({marginBottom:f?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),Ee={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},Le={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},d={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},l={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},U={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},ze={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},Y={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},De={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},Te={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},Be={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},X={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{qe as default};
