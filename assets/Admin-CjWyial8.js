import{r as i,j as e}from"./vendor-yu5OYTCw.js";import{p as Me,d as a,a as E}from"./index-DaQ9Zv-s.js";import{c as z,h as Oe,s as Ue,j as Ye,k as b,f as r,l as ue,q as N,o as P,b as xe,e as me,u as _,m as $e,d as ye}from"./vendor-firebase-C2tt4pnL.js";import{n as Ge,o as Xe,p as Je,f as fe,q as Ke,r as he,T as q,s as Qe,t as ge,C as Ve,u as Ze}from"./vendor-icons-CmTrnPo8.js";import"./vendor-animation-Duxi266C.js";function ut(){const[c,Se]=i.useState(null),[R,Ce]=i.useState(""),[M,ke]=i.useState(""),[O,U]=i.useState(!1),[l,we]=i.useState(window.innerWidth<900),[S,Y]=i.useState("events"),[$,Ee]=i.useState([]),[G,A]=i.useState(""),[X,f]=i.useState(""),[J,C]=i.useState(""),[K,k]=i.useState(""),[u,B]=i.useState("course"),[h,m]=i.useState(!1),[Q,I]=i.useState(""),[V,g]=i.useState(""),[y,Z]=i.useState(null),[ee,ze]=i.useState([]),[De,Te]=i.useState([]),[W,te]=i.useState(""),[se,ie]=i.useState(""),[ne,ae]=i.useState(""),le=z(a,"events"),Le=z(a,"rent_requests"),oe=z(a,"rental_availability"),j=Array.from(new Map(Me.filter(t=>t.type==="courses").flatMap(t=>t.courses||[]).filter(t=>t.link).map(t=>[t.link,t])).values());i.useEffect(()=>{const t=()=>we(window.innerWidth<900);window.addEventListener("resize",t);const s=Oe(E,n=>{Se(n),n&&(F(),re(),Re(),Ae())});return()=>{s(),window.removeEventListener("resize",t)}},[]);const Re=()=>{ye(N(Le,P("createdAt","desc")),t=>{ze(t.docs.map(s=>({id:s.id,...s.data()})))}),ye(N(oe,P("date","asc")),t=>{const s=new Date;s.setHours(0,0,0,0);const w=t.docs.map(x=>({id:x.id,...x.data()})).filter(x=>{const p=new Date(x.date);return p.setHours(0,0,0,0),p<s?(b(r(a,"rental_availability",x.id)),!1):!0});Te(w)})},Ae=async()=>{const t=await xe(z(a,"settings"));if(!t.empty){const s=t.docs.find(n=>n.id==="admin_config");s&&ae(s.data().adminEmail||"")}},Be=async()=>{try{await ue(r(a,"settings","admin_config"),{adminEmail:ne},{merge:!0}),alert("Notification email saved!")}catch(t){alert("Error saving email: "+t.message)}},F=async()=>{try{const t=N(le,P("date","asc")),s=await xe(t),n=new Date;n.setHours(0,0,0,0);const x=s.docs.map(p=>({...p.data(),id:p.id})).filter(p=>{const pe=new Date(p.date);return pe.setHours(0,0,0,0),pe<n?(b(r(a,"events",p.id)),!1):!0});Ee(x)}catch(t){console.error("Error fetching events:",t)}},re=()=>{j.length>0&&!y&&!h&&de(j[0].link)},de=t=>{const s=j.find(n=>n.link===t);I(t),s&&(C(s.text.en),k(s.text.de),s.text.en.toLowerCase().includes("pottery tuesdays")?f("18:30 - 21:30"):f(""))},Ie=async t=>{t.preventDefault();try{const n={date:G,time:X,title:{en:J,de:K},link:u==="event"||h?V:Q,type:u};y?await ue(r(a,"events",y),n):await me(le,n),ce(),F()}catch(s){alert("Error saving: "+s.message)}},We=async()=>{if(!W)return alert("Select a date");await me(oe,{date:W,time:se,status:"available"}),te(""),ie("")},Fe=async t=>{await _(r(a,"rent_requests",t),{status:"approved"})},Ne=async(t,s)=>{await _(r(a,"rent_requests",t),{status:"rejected"}),s&&await _(r(a,"rental_availability",s),{status:"available"})},Pe=async t=>{window.confirm("Delete this availability?")&&await b(r(a,"rental_availability",t))},_e=async t=>{window.confirm("Delete this request?")&&await b(r(a,"rent_requests",t))},qe=t=>{Z(t.id),A(t.date),f(t.time||""),C(t.title.en),k(t.title.de);const s=t.type||(t.link?.startsWith("http")?"event":"course");B(s),s==="course"?j.some(w=>w.link===t.link)?(I(t.link),g(""),m(!1)):(g(t.link),m(!0)):g(t.link||""),window.scrollTo({top:0,behavior:"smooth"})},ce=()=>{Z(null),A(""),f(""),g(""),C(""),k(""),m(!1),u==="course"&&re()},He=async t=>{t.preventDefault(),U(!0);try{await $e(E,R,M)}catch(s){alert("Login failed: "+s.message)}finally{U(!1)}};return c?e.jsxs("div",{style:{padding:l?"1.5rem":"4vw",minHeight:"100vh",fontFamily:"Satoshi",color:"#1c0700"},children:[e.jsxs("header",{style:it(l),children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:l?"2.2rem":"3.5rem",marginBottom:"0.2rem"},children:"Atelier Management"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem"},children:["Admin: ",c.email]})]}),e.jsxs("button",{onClick:()=>Ye(E),style:nt,children:[e.jsx(Je,{size:16})," ",!l&&"Logout"]})]}),e.jsxs("div",{style:et,children:[e.jsxs("button",{onClick:()=>Y("events"),style:je(S==="events"),children:[e.jsx(fe,{size:18})," Events & Courses"]}),e.jsxs("button",{onClick:()=>Y("rental"),style:je(S==="rental"),children:[e.jsx(Ke,{size:18})," Rental Requests"]})]}),S==="events"&&e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem",marginBottom:"5rem"},children:[e.jsx("section",{style:{width:l?"100%":"400px"},children:e.jsxs("div",{style:be,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.2rem"},children:[e.jsx("h3",{style:T,children:y?"EDIT ENTRY":"NEW ENTRY"}),y&&e.jsxs("button",{onClick:ce,style:lt,children:[e.jsx(he,{size:14})," CANCEL"]})]}),e.jsxs("form",{onSubmit:Ie,style:{display:"flex",flexDirection:"column",gap:"1.2rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:d,children:"Source"}),e.jsxs("div",{style:ve,children:[e.jsx("div",{onClick:()=>{B("course"),m(!1)},style:{...L,backgroundColor:u==="course"?"#caaff3":"transparent"},children:"Course"}),e.jsx("div",{onClick:()=>B("event"),style:{...L,backgroundColor:u==="event"?"#caaff3":"transparent"},children:"Event"})]})]}),u==="course"&&e.jsxs("div",{children:[e.jsx("label",{style:d,children:"Link Source"}),e.jsxs("div",{style:{...ve,backgroundColor:"#f9f9f9",border:"1px solid #eee"},children:[e.jsx("div",{onClick:()=>m(!1),style:{...L,fontSize:"0.7rem",padding:"6px 12px",backgroundColor:h?"transparent":"#eee"},children:"Predefined"}),e.jsx("div",{onClick:()=>{m(!0),I("")},style:{...L,fontSize:"0.7rem",padding:"6px 12px",backgroundColor:h?"#eee":"transparent"},children:"Custom URL"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"date",value:G,onChange:t=>A(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Time",value:X,onChange:t=>f(t.target.value),style:o})]}),u==="course"&&!h?e.jsx("select",{value:Q,onChange:t=>de(t.target.value),style:o,required:!0,children:j.map((t,s)=>e.jsx("option",{value:t.link,children:t.text.en},s))}):e.jsx("input",{type:"url",placeholder:"URL https://...",value:V,onChange:t=>g(t.target.value),style:o,required:!0}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Title EN",value:J,onChange:t=>C(t.target.value),required:!0,style:o}),e.jsx("input",{type:"text",placeholder:"Title DE",value:K,onChange:t=>k(t.target.value),required:!0,style:o})]}),e.jsx("button",{type:"submit",style:D,children:y?"Update Entry":"Add to Calendar"})]})]})}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:T,children:[e.jsx(fe,{size:16})," Scheduled Events (",$.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.8rem"},children:$.map(t=>e.jsxs("div",{onClick:()=>qe(t),style:H,children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"#caaff3",fontWeight:"800"},children:[t.date," ",t.time&&`• ${t.time}`]}),e.jsx("span",{style:{fontWeight:"600"},children:t.title.en})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),window.confirm("Delete?")&&b(r(a,"events",t.id)).then(F)},style:v,children:e.jsx(q,{size:18})})]},t.id))})]})]}),S==="rental"&&e.jsxs("div",{style:{display:l?"block":"flex",gap:"2rem"},children:[e.jsxs("section",{style:{width:l?"100%":"400px"},children:[e.jsxs("div",{style:be,children:[e.jsxs("h3",{style:T,children:[e.jsx(Qe,{size:16})," Set Availability"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("input",{type:"date",value:W,onChange:t=>te(t.target.value),style:o}),e.jsx("input",{type:"text",placeholder:"Time slot (e.g. 10:00 - 16:00)",value:se,onChange:t=>ie(t.target.value),style:o}),e.jsx("button",{onClick:We,style:{...D,backgroundColor:"#4e5f28",color:"white"},children:"Publish Date"})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h4",{style:d,children:"Persistent Notification Email"}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"email",placeholder:"Admin notification email",value:ne,onChange:t=>ae(t.target.value),style:{...o,flex:1}}),e.jsx("button",{onClick:Be,style:{...D,width:"auto",padding:"0 15px"},title:"Save Email to Settings",children:e.jsx(ge,{size:16})})]})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:d,children:"Live Availabilities"}),De.map(t=>e.jsxs("div",{style:{...H,padding:"0.8rem",marginBottom:"0.5rem",opacity:t.status==="available"?1:.5},children:[e.jsxs("span",{style:{fontSize:"0.85rem"},children:[t.date," — ",e.jsx("strong",{children:t.status})]}),e.jsx("button",{onClick:()=>Pe(t.id),style:v,children:e.jsx(q,{size:14})})]},t.id))]})]}),e.jsxs("section",{style:{flex:1},children:[e.jsxs("h3",{style:T,children:[e.jsx(Ve,{size:16})," Incoming Rent Requests (",ee.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:ee.map(t=>e.jsxs("div",{style:{...H,alignItems:"flex-start",flexDirection:"column",borderLeft:t.status==="approved"?"6px solid #4e5f28":t.status==="rejected"?"6px solid #ff4d4d":"6px solid #caaff3"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:t.name}),t.status!=="pending"&&e.jsx("span",{style:{fontSize:"0.6rem",background:"#eee",padding:"2px 8px",borderRadius:"100px",textTransform:"uppercase"},children:t.status})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Fe(t.id),style:{...v,color:"#4e5f28",opacity:1},children:e.jsx(Ze,{size:22})}),e.jsx("button",{onClick:()=>Ne(t.id,t.availabilityId),style:{...v,color:"#ff4d4d",opacity:1},children:e.jsx(he,{size:22})})]}),e.jsx("a",{href:`mailto:${t.email}`,style:{color:"#caaff3"},children:e.jsx(ge,{size:20})}),e.jsx("button",{onClick:()=>_e(t.id),style:v,children:e.jsx(q,{size:20})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:l?"1fr":"1fr 1fr",gap:"10px",width:"100%",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Email:"})," ",t.email]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Phone:"})," ",t.phone]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Requested Date:"})," ",e.jsx("strong",{children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{style:d,children:"Received:"})," ",new Date(t.createdAt).toLocaleDateString()]})]})]},t.id))})]})]})]}):e.jsx("div",{style:tt,children:e.jsxs("form",{onSubmit:He,style:st(l),children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx(Ge,{size:l?32:40,color:"#caaff3",style:{marginBottom:"1rem"}}),e.jsx("h1",{style:{fontFamily:"Harmond-SemiBoldCondensed",fontSize:"2rem"},children:"Atelier Login"})]}),e.jsx("label",{style:d,children:"Email"}),e.jsx("input",{type:"email",value:R,onChange:t=>Ce(t.target.value),style:{...o,marginBottom:"1.2rem"},required:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsx("label",{style:d,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>Ue(E,R),style:at,children:"Forgot?"})]}),e.jsx("input",{type:"password",value:M,onChange:t=>ke(t.target.value),style:{...o,marginBottom:"2rem"},required:!0}),e.jsx("button",{type:"submit",disabled:O,style:D,children:O?e.jsx(Xe,{className:"spinner",size:18}):"Sign In"})]})})}const et={display:"flex",gap:"10px",marginBottom:"2.5rem",borderBottom:"1px solid #eee",paddingBottom:"10px"},je=c=>({display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px",borderRadius:"12px",border:"none",cursor:"pointer",fontFamily:"Satoshi",fontWeight:"bold",fontSize:"0.9rem",transition:"all 0.3s ease",backgroundColor:c?"#caaff3":"transparent",color:c?"#1c0700":"#1c070080"}),tt={display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"1.5rem"},st=c=>({backgroundColor:"white",padding:c?"2rem":"3rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.05)",width:"100%",maxWidth:"400px"}),it=c=>({marginBottom:c?"2rem":"4rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"}),nt={display:"flex",alignItems:"center",gap:"8px",background:"white",border:"1px solid #1c0700",padding:"10px 14px",borderRadius:"10px",cursor:"pointer",fontWeight:"bold"},be={backgroundColor:"#ffffff",padding:"1.8rem",borderRadius:"24px",boxShadow:"0 10px 40px rgba(28, 7, 0, 0.04)"},d={display:"block",fontSize:"0.65rem",marginBottom:"6px",opacity:.5,fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},o={width:"100%",padding:"0.85rem",borderRadius:"12px",border:"1px solid #eee",fontFamily:"Satoshi",boxSizing:"border-box",outline:"none",fontSize:"1rem"},D={marginTop:"0.5rem",padding:"1rem",backgroundColor:"#caaff3",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"bold",color:"#1c0700",fontSize:"1rem",width:"100%"},at={background:"none",border:"none",color:"#caaff3",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",textTransform:"uppercase",padding:0},T={fontSize:"0.9rem",marginBottom:"1.2rem",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.05rem"},lt={background:"none",border:"none",color:"#ff4d4d",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.7rem",fontWeight:"bold"},H={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.2rem",backgroundColor:"#fff",borderRadius:"18px",boxShadow:"0 4px 15px rgba(28, 7, 0, 0.02)",transition:"all 0.2s ease"},v={color:"#ff4d4d",background:"none",border:"none",cursor:"pointer",opacity:.4,padding:"8px"},ve={display:"flex",backgroundColor:"#f0f0f0",padding:"4px",borderRadius:"12px",width:"fit-content"},L={padding:"8px 20px",borderRadius:"9px",cursor:"pointer",fontSize:"0.85rem",fontWeight:"600",transition:"all 0.2s ease"};export{ut as default};
